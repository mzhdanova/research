\chapter{Скрытые полумарковские модели источников ошибок.} \label{chapt2}
- Полиномиальное представление скрытой полумарковской модели фергюсоновского типа

Видимо пока объединить полумарковские QP-модели и полиномиальное представление.
\section{Скрытая марковская модель источника ошибок в $q$-ичном
цифровом канале.}
Рассмотрим  симметричный цифровой  канал передачи данных \emph{N} физических состояний, по которому передается информация в виде последовательностей символов $q$-ичного алфавита, отождествляемого с полем Галуа $\mathbb{F}_q$. Построим модель источника ошибок в таком канале на основе классической СММ, описанной в разделе 1.2.
Определим \emph{q}-ичную марковскую модель источника ошибок следующим образом:

1) физические состояния канала будем моделировать алфавитом математических состояний $S=\{S_1, S_2, ..., S_N \}$ мощности \emph{N};

2) вероятности перехода канала из состояния в состояние зададим матрицей переходных вероятностей
$$A=
        \left(\begin{array}{cccc}
           a_{11} & a_{12} & \ldots & a_{1N} \\
           a_{21} & a_{22} & \ldots & a_{2N} \\
           \vdots & \vdots & \ddots & \vdots \\
           a_{N1} & a_{N2} & \ldots & a_{NN}
        \end{array}\right),$$
где $a_{ij} = P[q_t=S_j|q_{t-1}=S_i]$, $q_t$ - состояние канала в момент $t$;

3) зададим вектор начального распределения вероятностей состояний
$$\pi=\{ \pi_1, \pi_2, \ldots, \pi_N \},$$
где $\pi_i=P[q_1=S_i]$ ;

4) в качестве алфавита наблюдаемых символов возьмем конечное поле --- поле Галуа $ \mathbb{F}_q=\{v_0, v_1,\ldots , v_{q-1}\}$, где мощность \emph{q} является простым числом или степенью простого числа;

5) зададим матрицу вероятностей появления наблюдаемых символов $v_k$  в состоянии  $S_j$:
$$B=
        \left(\begin{array}{cccc}
           b_{10} & b_{11} & \ldots & b_{1q-1} \\
           b_{20} & b_{21} & \ldots & b_{2q-1} \\
           \vdots & \vdots & \ddots & \vdots \\
           b_{N0} & b_{N1} & \ldots & b_{Nq-1}
        \end{array}\right),$$
где $b_{jk} = P[r_t= v_k | q_t = S_j]$, $r_t$ - символ, наблюдаемый в момент времени $t$.

Моделирование потока ошибок происходит в два этапа.

\textbf{Этап 1.} В соответствии с начальным распределением $\pi$ в первый момент времени и матрицей переходных вероятностей \emph{A} в последующие моделируется состояние канала в текущий момент.

\textbf{Этап 2.} С учетом выбранного состояния исходя из матрицы условных вероятностей \emph{B} генерируется значение ошибки. Понятно, что в силу аддитивности помех появление нулевого символа $v_0=0$ соответствует отсутствию ошибки.

Частными случаями описанной модели являются такие классические модели как модель Гильберта, Гильберта-Эллиота, Фричмана и многие другие. Действительно, модель Гильберта получится из предлагаемой в данном разделе модели при следующих предположениях:

1) рассматривается бинарный (над полем $\mathbb{F}_2$) канал двух состояний;

2) первое состояние считается "хорошим"\; в том смысле, что вероятность ошибки в нем $b_1(1)=0$;

3) вероятность ошибки во втором ("плохом"\;) состоянии $b_2(1)$ полагается равной некоторому $\varepsilon$;

4) накладываются ограничения на матрицу перехода:
$$a_{12}<<a_{11}, \;\;\; a_{21}<<a_{22}.$$

 Модель Гильберта-Эллиота получается при тех же предположениях относительно канала, но без разделения на "хорошее" \; и "плохое"\; состояния.

 Модель  Фричмана также является частным случаем рассматриваемой модели и может быть получена, если положить:

 1) число состояний равным $N$;

 2) матрицу переходных вероятностей имеющей вид
  $$A=
         \left(\begin{array}{ccccc}
           A_{11} & 0 & \ldots & 0 & A_{1N} \\
           0 & A_{22} & \ldots & 0 & A_{2N} \\
           \vdots & \vdots & \ddots & \vdots & \vdots \\
           0 & 0 & \ldots & A_{N-1,N-1} & A_{N-1,N}\\
           A_{N,1} & A_{N,2} & \ldots & A_{N,N-1}& A_{N,N}
        \end{array}\right);$$

  3) мощность выходного алфавита равной 2 (т. е. алфавит наблюдаемых символов --- поле $\mathbb{F}_2$);

  4) матрицу вероятностей появления наблюдаемых символов равной
      $$B=
        \left(\begin{array}{cccc}
           1 & 0 \\
           1 & 0  \\
           \vdots & \vdots \\
           1-\varepsilon & \varepsilon
        \end{array}\right).$$


\section{Скрытая полумарковская QP-модель.} \label{sect2_1}

Неявно (а если понадобится, то явно) выделить три части:

1) абстрактная модель с предварительными сведениями о QP-модели

2) генерирование ошибок как алгоритм

3) связь с Ю

//TODO:переработать когда будет готов обзор.

Один из подходов к моделированию источников ошибок заключается в использовании цепей Маркова.
Этот подход позволяет с любой степенью точности аппроксимировать статистику ошибок в канале \cite{MogOVlozh}.
На его основе построены многие известные модели, такие как, например, модель Элиота--Гильберта и модель
Смита--Боуэна--Джойса \cite{DeMoMet1}. В настоящее время марковские процессы нашли применение
при моделировании мешающего воздействия в следящих системах и при исследовании помехоустойчивости
в дискретных системах синхронизации \cite{SerBel}. Другой подход к моделированию источников ошибок
представлен в  \cite{DeMoRGUPS}, \cite{DeMoSevKav}, где на основе использования квазипериодических
последовательностей случайных величин построена математическая модель источника ошибок канала ---
$q$-ичная $QP$-модель,  обобщающая  многие известные модели, например, модели Турина и Турина--Попова,
которые, в свою очередь, являются обобщениями других известных моделей, таких как модель Гильберта,
модель Бергера--Манделброта, модель Элиота и другие (см. \cite{Turin71}, \cite{DeMoMet1}).

В скрытой полумарковской QP-модели соединяются преимущества обоих этих подходов. Будем говорить, что реальный канал
передачи данных находится в \emph{фиксированном физическом состоянии}, если основные параметры
его помеховой обстановки относительно стабильны.
Целью раздела является  построение марковской модели канала $n$ физических состояний,
каждое из которых описывается $q$-ичной $QP$-моделью.

---

В статьях \cite{DeZhdaIvan}, \cite{DeZhdaObozr11} была представлена модель источника ошибок, объединившая два различных подхода к моделированию помеховой обстановки в канале --- подход, основанный на использовании теории цепей Маркова, и QP-модель, разработанную в \cite{DeMoRGUPS}. Эту модель будем в дальнейшем называть скрытой полумарковской QP-моделью источника ошибок. Приведем описание СПМQP-модели и покажем, каким образом ее можно вложить в общую скрытую полумарковскую модель, представленную в  \cite{Yu}.

\subsection{Квазипериодические последовательности случайных величин.}
Приведем сведения из \cite{DeMoRGUPS}, \cite{DeMoSevKav},
необходимые для будущего построения cкрытой марковской $QP$-модели цифрового канала $C$. Пусть $p_{tr}$ - вероятность достоверной передачи символа в канале, а $p_{er} = 1 - p_{tr}$ - вероятность ошибочной передачи символа. Следуя \cite{DeMoRGUPS}, \cite{DeMoSevKav}, рассмотрим вероятностное пространство

$$S = (\Omega, A, p),$$
где  $\Omega=\{t;e\}$ (\emph{e} соответствует наличию, а  \emph{t} - отсутствию ошибки); $A$ - множество всех подмножеств $\Omega$; $p:A\rightarrow[0,1]$ - вероятностная функция, определяемая условием: $$p(t)=p_{tr},\;\;\; p(e)=p_{er}.$$

Отрезок числовой оси $\mathbb{R}$ с целочисленными концами $a$ и $b$ $(a<b)$ будем обозначать $[a,b]$, а соответствующий отрезок множества целых чисел $\mathbb{Z}$ обозначим  $[a,b]_{\mathbb{Z}}$. Под длиной $[a,b]_{\mathbb{Z}}$ будем понимать $b-a+1$.

Зададим на отрезке $L=[0,{T-1}]_{\mathbb{Z}}$ дискретной временной оси канала плотность $\rho$, для которой выполняется следующее \textit{условие адаптированности к каналу} $C$:
  \begin{equation}
  \label{lb_addopt_condition}
  \forall i\in L=[0,T-1]_{\mathbb{Z}}: \rho(i)\leq 1/(T\cdot p_{er})\leq1.
  \end{equation}

Далее с помощью $\rho$ будет имитироваться плотность распределения позиций ошибок внутри временного отрезка \emph{L}. Для каждого $i\in L$ рассмотрим вероятностное пространство
$$S_{i}=(\Omega, A, p_{i}),$$
где вероятностная функция $p_{i}$ задана условиями:
$$p_{i}(e)=p(i)\cdot p_{er}\cdot T,  p_{i}(t)=1-p_{i}(e),$$
и определим на $S_{i}$ случайную величину  $\Xi^{(L)}_{i}$, принимающую значения в поле Галуа $\mathbb{F}_{2}=\{0;1\}:$   $$\Xi^{(L)}_{i}(e)=1,  \;\;\; \Xi^{(L)}_{i}(t)=0.$$

Конечную последовательность  $\Xi^{(L)}=\{\Xi^{(L)}_{i}\}_{i\in L}$ назовем \emph{адаптированным  к q-ичному каналу эталонным вектором двоичных случайных величин}.

Опишем механизм из \cite{DeMoRGUPS}, позволяющий масштабировать адаптированные к каналу эталонные векторы случайных величин. Рассмотрим на отрезке $L=[0,T - 1]_{\mathbb{Z}}$  адаптированную к каналу C дискретную плотность $\rho$ и соответствующий эталонный вектор случайных величин  $\Xi^{(L)}$. Определим на промежутке $[0,J)\subset \mathbb{R}$, где $J>1/p_{er}$, кусочно-постоянную плотность  $\varphi^{pc}$:
  $$\forall i\in L: \;\;\;\;\; \varphi^{pc}\mid _{(iq,(i+1)q]}=(T/J)\cdot \rho(i) \;\;\; (\text {где \;} q=J/T)$$
и зададим на $M=[0,J-1]_{\mathbb{Z}}$ адаптированную к каналу дискретную плотность:
$$\varphi (j) = \int\limits_{j}^{j+1} \varphi^{pc}(x)dx$$
(см. (\ref{lb_addopt_condition})). Плотность $\rho$, длина временного отрезка \emph{J} и параметр $p_{er}$ определяют набор вероятностных пространств вида
$$S'_{j}=(\Omega,A,p_{j}), \;\;\; j\in M,$$
где $$p'_{j}(e)=\varphi(j)\cdot p_{er}\cdot J, \;\;\;  p'_{j}(t)=1-p'_{j}(e),$$
и  $\varphi$-эталонный вектор случайных величин $\Xi^{(M)}$. Вектор $\Xi^{(M)}$ далее будем называть \emph{масштабным растяжением}  $\varphi$-эталонного вектора  $\Xi^{(L)}$ на отрезок $M=[0,J-1]_{\mathbb{Z}}$.

Представим дискретную временную ось $\mathbb{Z}$ канала $С$ в виде случайной последовательности целочисленных отрезков $$L_{1}, L_{2},..., L_{k},... ,$$
длины которых $T_{k}$ распределены по некоторому закону \emph{f(Т)}, и предположим, что
 $$\forall k: \;\;\;  1/(T_{k}\cdot p_{er})\leq 1.$$

Отрезки $L_{k}$ назовем \emph{квазипериодами}.

Рассмотрим теперь адаптированную к каналу дискретную плотность $\rho$, заданную на эталонном отрезке $L_{0}=[0 , T_{0} -1]_{\mathbb{Z}}$, и соответствующий $\rho$-эталонный вектор случайных величин $\Xi^{(L_{0})}$.

Пусть $\Xi^{(L_{k,0})}$- масштабное растяжение вектора $\Xi^{(L_{0})}$ на отрезок $L_{k}=[0, T_{k} -1]_{\mathbb{Z}}$, а $\Xi^{(L_{k})}=\{\Xi_{i}^{(L_{k})}\}_{i\in L_{k}}$  - сдвиг вектора $\Xi^{(L_{k,0})}=\{\Xi_{i}^{(L_{k,0})}\}_{i\in L_{0}}$  вдоль временной оси на $W_{k}=\sum\limits_{j=1}^{k-1} T_{j} $, то есть ${\Xi_{i+W_{k}}^{(L_{k})}}={\Xi_{i}^{(L_{k,0})}}$, где $i\in [0, T_{k} -1]_{\mathbb{Z}}$.

 Вектор случайных величин $\Xi^{(L_{k})}$ будем называть \emph{масштабным переносом} $\rho$-эталонного вектора $\Xi^{(L_{0})}$ на отрезок $L_{k}$.  На вероятностном пространстве
 \begin{equation}
 \label{lb_probabalistic_space}
 {\Sigma_{i}^{(L_{k})}}=(F_{q},A_{q},{\pi_{i}^{(L_{k})}}), \;\;\; i\in L_{k}
 \end{equation}
 рассмотрим конкатенацию последовательности векторов
 $$\Xi^{(L_{1})}, \Xi^{(L_{2})},..., \Xi^{(L_{k})},...,$$
 которая задает последовательность $\Xi=\{\Xi_{i} \}_{i\in \mathbb{Z}}$ случайных величин. Пусть
 $$\Sigma_{i}(\Omega,A,\pi_{i}), \;\;\; i\in \mathbb{Z} $$
 --- вероятностное пространство типа (\ref{lb_probabalistic_space}), на котором определена случайная величина $\Xi_{i}$. Построенную последовательность  $\Xi=\{\Xi_{i} \}_{i\in \mathbb{Z}}$ будем называть \emph{квазипериодической последовательностью случайных величин с $\rho$-эталонным вектором $\Xi^{(L_{0})}$  и распределением длин квазипериодов $f(T)$}.

\subsection{Схема \emph{q}-ичной \textit{QP}-модели.}
Используя математический аппарат теории квазипериодических последовательностей случайных величин, построим математическую модель источника ошибок \emph{q}-ичного канала передачи данных.

Рассмотрим \emph{q}-ичный цифровой канал $C$. Входными параметрами модели источника ошибок канала $C$ являются:

1) вероятность $P^{er}$ ошибочной передачи байта;

2) адаптированный к каналу $\rho$-эталонный вектор случайных величин $\Xi^{(L_{0})}$;

3) адаптированное к каналу распределение \emph{f(T)} длин квазипериодов;

4) определенная на вероятностном пространстве ненулевых значений ошибок $S_{q}=(\mathbb{F}_{q}^{\ast}, A_{q}^{\ast}, p_{smb})$ случайной величиной $\zeta$:
$$\zeta(\lambda)=\lambda, \;\;\;\;\; \lambda\in \mathbb{F}_{q}^{\ast}.$$
(Здесь и далее $\mathbb{F}_{q}^{\ast}$ - мультипликативная группа поля Галуа $\mathbb{F}_{q}$, а  $A_{q}^{\ast}$ --- множество всех подмножеств $\mathbb{F}_{q}^{\ast}$).

 Эту модель назовем \textit{математической моделью источника квазипериодических случайных ошибок} ($QP$-моделью) над $q$-ичным каналом. Будем говорить, что канал \textit{находится в математическом $QP$-состоянии}, если его источник ошибок описан $QP$-моделью. В случае постоянства длин всех квазипериодов будем говорить о \textit{математической модели источника периодических случайных ошибок} ($P$-модели).

Опишем процесс моделирования  $q$-ичного потока ошибок на основе построенной модели. Сначала построим так называемую последовательность позиций ошибок, которая генерируется посредством реализации соответствующей квазипериодической последовательности случайных величин $\Xi=\{\Xi_i\}$. Следует отметить, что последовательность $\{\Xi_i\}$ определяет только наличие либо отсутствие ошибки.

После определения позиций ошибок, возникает вопрос об их значениях. В связи с этим рассмотрим вероятностное пространство $$\Sigma_{i}^{\Delta}=(\mathbb{F}_{q},A_{q},p_{i}^{\Delta}),$$
полагая для произвольного $\xi\in \mathbb{F}_{q}$:
 $$p_{i}^{\Delta}(\xi)= \pi_{i}(1)\cdot p_{smb}(\xi),\;\;\; \xi\neq 0,$$
 $$ p_{i}^{\Delta}(0)=\pi_{i}(0).$$

Определим отображение $\tau$: $\mathbb{F}_{2}\times \mathbb{F}^{\ast}_{q}\rightarrow \mathbb{F}_{q}$  условиями:
$$\forall \eta\in \mathbb{F}^{\ast}_{q}: \tau(0,\eta)=0, \;\;\;\;\;\;\forall \eta\in \mathbb{F}^{\ast}_{q}: \tau(1,\eta)=\eta.  $$

На вероятностном пространстве $\Sigma_{i}^{\Delta}$ зададим случайную величину $\Xi^{\Delta}_{i} $ следующим образом:
$$\Xi^{\Delta}_{i}(\xi)=\Xi_{i}(j)\cdot \zeta(\eta),$$
$$ \tau(j,\eta)=\xi.$$

Покажем, что такое определение корректно. Действительно, если $\emph{j = 1}$, то $\forall \eta\in \mathbb{F}^{\ast}_{q}$ \;\;\; $\xi=\eta$. Если же $\emph{j = 0}$, формально полагаем $\eta=1$. При таком предположении $\xi=0$ и $\Xi^{\Delta}_{i}$ определяется корректно.

В математической модели источника квазипериодических случайных $q$-ичных ошибок, то есть в $q$-ичной $QP$-модели, поток ошибок определим как реализацию $q$-ичной последовательности $\Xi^{\Delta}=\{\Xi^{\Delta}_{i}\}_{i\in \mathbb{Z}}$.

Итак, построенная модель задает $q$-ичный поток ошибок, нулевые элементы которого соответствуют отсутствию ошибки в информационном потоке, а ненулевые элементы указывают на значение ошибки.

\subsection{Скрытая полумарковская QP-модель}

\textbf{1.} Рассмотрим цифровой канал передачи данных $C$, по которому передается информация
в виде последовательностей символов $q$-ичного алфавита, отождествляемого с полем Галуа $F_{q}$.
Будем полагать, что этот $q$-ичный канал имеет $n$ физических состояний $s^{[1]},\,\ldots,\,s^{[n]}$,
каждое из которых описывается математическим $QP$-состоянием. Это означает, что каждому состоянию
$s^{[j]}$ соответствует некоторый источник квазипериодических случайных ошибок, который
в соответствии с описываемой $QP$-моделью задается следующими входными параметрами:

\noindent\phantom{~~}$\bullet$\phantom{~~}%
средней вероятностью ошибочной передачи символа $p_{\rm \, er}^{[j]}$;

\noindent\phantom{~~}$\bullet$\phantom{~~}%
заданной на эталонном отрезке $L_{0}^{[j]}$  длины $T_{0}^{[j]}$ адаптированной к каналу
плотностью $\rho^{[j]}$  (см. (\ref{lb_addopt_condition})), для которой
$$
\sum_{i=0}^{T^{[j]}-1}\rho^{[j]}(i)=1;
$$
\noindent\phantom{~~}$\bullet$\phantom{~~}%
адаптированным к каналу бинарным  $\rho^{[j]}$-эталонным вектором случайных величин $\Xi^{(L_{0}^{[j]})}$;

\noindent\phantom{~~}$\bullet$\phantom{~~}%
распределением длин квазипериодов $f^{[j]}(T)$ с математическим ожиданием длины квазипериода $T^{[j]}$,
для которых выполняется условие адаптированности (\ref{lb_addopt_condition});

\noindent\phantom{~~}$\bullet$\phantom{~~}%
определенной на вероятностном пространстве ненулевых значений ошибок
$S_{q}^{[j]}=(F_{q}^{*},\, A_{q}^{*},\, p_{\rm \, smb}^{[j]})$ случайной величиной
$\zeta^{[j]}$:\ $\zeta^{[j]}(\lambda)=\lambda,\ \lambda\in F_{q}^{*}$.
(Здесь и далее $F_{q}^{*}$ --- мультипликативная группа поля Галуа $F_{q}$,
а  $A_{q}^{*}$ --- множество всех подмножеств $F_{q}^{*}$).

Набор  $\Phi=\{s^{[1]},\, s^{[2]},\,\ldots,\, s^{[n]}\}$ назовем алфавитом состояний канала.
Переход от состояния к состоянию реализуется заданием марковской матрицы переходных вероятностей
\begin{equation}
\label{lb_trans_matr}
K=
        \left(\begin{array}{cccc}
           p_{11} & p_{12} & \ldots & p_{1n} \\
           p_{21} & p_{22} & \ldots & p_{2n} \\
           \vdots & \vdots & \ddots & \vdots \\
           p_{n1} & p_{n2} & \ldots & p_{nn}
        \end{array}\right),
\end{equation}
где $p_{ij}$ --- вероятность перехода канала из состояния $s^{[i]}$ в состояние $s^{[j]}$.
Заметим, что матрица $K$ --- стохастическая, т.~е.
\begin{equation}
\forall\ i,j:\ 0 \leq p_{ij}\leq 1;\ \ \forall\ i:\ \sum _{j=1}^{n} p_{ij} =1.
\end{equation}
Предельные вероятности марковского процесса $P_{\rm \, lim}^{[i]}$  $(i\in [1,\,n]_Z)$ определяются из соотношений:
\begin{equation}
\label{lb_system_equation}
           \left\{
           \begin{array}{rcl}
            \sum\limits_{j=1}^{n}P_{\rm \, lim}^{[j]} & = & 1, \\
             \sum\limits_{j=1}^{n}P_{\rm \, lim}^{[j]}\cdot p_{ji}   & = & P_{\rm \, lim}^{[i]},\ \ i\in [1,n]_Z. \\
           \end{array}
           \right.
\end{equation}

\begin{remark} \rm
В \cite{Bellman} доказано, что система (\ref{lb_system_equation}) разрешима единственным образом только в случае,
если выполнено условие регулярности для  матрицы (\ref{lb_trans_matr}):
 1) у  матрицы $K$ нет характеристических чисел, отличных от единицы и равных по модулю единице, и
 2) единица является простым корнем характеристического уравнения матрицы $K$.
\end{remark}

Будем предполагать, что средняя вероятность ошибочной передачи символа в канале равна $P_{\rm \, er}$.
Введем условие согласования:
$$
P_{\rm \, er}=\sum_{i=1}^{n}P_{\rm \, er}^{[i]}\cdot P_{\rm \, lim}^{[i]}.
$$
Таким образом, мы определили параметры марковской математической модели источника ошибок
$q$-ичного цифрового канала нескольких физических состояний на основе $QP$-модели,
которую будем называть марковской $q$-ичной $QP$-моделью.

\textbf{2.} Опишем теперь процесс моделирования $q$-ичного потока ошибок на основе построенной модели.
Сначала построим последовательность позиций ошибок. Для этого представим дискретную временную ось
в виде последовательности целочисленных отрезков переменной длины
$$
L_{1},\, L_{2},\,\ldots,\, L_{r},\ldots,
$$
где отрезок $L_{r}$ соответствует некоторому состоянию $s^{[j_r]}$, а его длина $T_{r}$
определяется согласно распределению длин квазипериодов для текущего состояния.
Каждому отрезку $L_{r}$  моделью сопоставляется бинарный вектор случайных величин
$\Xi^{(L_{r})}=\{\Xi_{i}^{(L_{r})}\}_{i\in L_{r}}$.
Для произвольного $r \in \{1;\,2;\,\ldots\}$ вектор $\Xi^{(L_{r})}$  является масштабным переносом
на отрезок $L_{r}$ бинарного  $\rho^{[j_r]}$-эталонного вектора случайных величин,
соответствующего  математическому $QP$-состоянию $s^{[j_r]}$.
Теперь рассмотрим последовательность случайных величин $\Xi = \{\Xi_{t}\}_{ t \in Z}$,
определяемую конкатенацией последовательности бинарных векторов
$$
\Xi^{(L_{1})},\,\Xi^{(L_{2})},\,\Xi^{(L_{3})},\,\ldots
$$
Эту последовательность будем называть последовательностью позиций ошибок.

После определения позиций ошибок возникает вопрос о значениях ошибок. Пусть $\sigma$ --- отображение,
ставящее каждому моменту времени $t\in\mathbb{Z}$ номер того состояния, в котором находится канал в этот момент.
По аналогии с (4) для каждого $t\in\mathbb{Z}$ рассмотрим  вероятностное пространство
$\Sigma_{t}=(\Omega,\, A,\,\pi_{t})$ типа (\ref{lb_probabalistic_space}), на котором определена случайная величина $\Xi_{t}$.
Рассмотрим также вероятностное пространство $\Sigma_{t}^{\Delta}=(F_{q},\,A_{q},\,p_{t}^{\Delta})$,
полагая для произвольного $\xi\in F_{q}$: $p_{t}^{\Delta}(\xi)= \pi_{t}(1)\cdot p_{\rm \, smb}^{[\sigma(t)]}(\xi)$,
если $\xi\neq 0$, и $p_{\rm \, smb}^{[\sigma(t)]}(0)=\pi_{t}(1)$. Определим отображение
$\tau$: $F_{2}\times F^{*}_{q}\rightarrow F_{q}$  условиями:
$$
\forall\ \eta\in F^{*}_{q}:\ \tau(0,\,\eta)=0,\ \tau(1,\,\eta)=\eta.
$$
Тогда случайную величину $\Xi^{\Delta}_{t} $ на вероятностном пространстве
$$
\Sigma_{t}^{\Delta}=(F_{q},\,A_{q},\,p_{t}^{\Delta})
$$
корректно зададим формулой
$$
\Xi^{\Delta}_{t}(\xi)=\Xi_{t}(j)\cdot \zeta^{[\sigma(t)]}(\eta),\ \ \tau(j,\,\eta)=\xi.
$$
В марковской математической модели источника квазипериодических случайных $q$-ичных ошибок,
т.~е. в скрытой полумарковской $QP$-модели, поток ошибок определим как реализацию $q$-ичной последовательности
${\Xi^{\Delta}=\{\Xi^{\Delta}_{t}\}_{t\in Z}}$.

Итак, построенная модель задает $q$-ичный поток ошибок, нулевые элементы которого соответствуют
отсутствию ошибки в информационном потоке, а ненулевые элементы указывают на значение ошибки.

\textbf{3.4.} Для удобства дальнейшего изложения опишем предложенную модель источника ошибок в терминах скрытых полумарковских моделей.

\begin{definition}Под CПМQP-моделью источника ошибок будем понимать набор $$\lambda =  \{\mathcal{S};\mathcal{D}; A; \Pi; p(d); \rho; \mu ;M ;{\mathbb{F}}_q;B \},$$
параметры которого определяются следующим образом.

$\mathcal{S}=\{1,...,N\}$ --- алфавит состояний дискретной полумарковской цепи, $\mathcal{D}=\{1,...,D\}$ -- алфавит возможных длительностей состояний.

$A=\{a_{ii^\prime}\}_{i,i^\prime\in \mathcal{S}}$ --- матрица переходных вероятностей, матричный элемент $a_{ii^\prime}$ которой представляют собой вероятность перехода из состояния $i$ в состояние $i^\prime$, то есть
$$\forall i,i^\prime \in \mathcal{S}: \;\;\; a_{ii^\prime} \triangleq P_\nu[S_{[t}=i^\prime|S_{t-1]}=i],$$
где $t$ --- момент времени, когда произошёл переход из обобщённого состояния $(i,d)$ в $(i^\prime,d^\prime)$. Для матрицы $A$ должно также выполняться условие стохастичности, то есть:

$$\forall i,i^\prime \in \mathcal{S}: 0\leq a_{ii^\prime} \leq 1$$
и
$$\forall i \in \mathcal{S}: \sum\limits_{i^\prime\in \mathcal{S}} a_{ii^\prime}=1.$$

$\Pi=\{\pi_{i}\}_{i\in \mathcal{S}}$ представляет собой исходное распределение вероятностей состояний. Элемент $\pi_{i}$  --- вероятность того, что система прибывала в состоянии $i$ до начала наблюдений. Таким образом, можно записать:
$$\forall i\in \mathcal{S}:\;\;\; \pi_{i}\triangleq P[S_{0}=i].$$

$p(d)=\{p_i(d)\}_{i\in\mathcal{S}}$ --- набор распределений вероятностей длительностей в различных состояниях, где $p_i(d)$ соответствует вероятности наблюдения состояния $i$ на протяжении в точности $d$ моментов времени. Сказанное можно записать в виде:
$$\forall (i,d) \in \mathcal{S}\times \mathcal{D}: \;\;\; p_i(d)\triangleq P[S_{t+1:t+d]}=i|S_{[t+1}=i].$$

$\rho=\{\rho_i(l)\}_{i\in\mathcal{S}, l \in L_i}$ --- вектор, составленный из эталонных плотностей, определяемых на эталонных отрезках $L=\{L_i\}_{i\in\mathcal{S}}$ длин $\Delta=\{\delta_i\}_{i\in\mathcal{S}}$, где

$$\forall i\in \mathcal{S}, l \in L_i :\;\;\; 0\leq \rho_i (l)\leq 1$$
и
$$\forall i\in \mathcal{S}:\;\;\; \sum\limits_{l\in L_i} \rho_i(l)=1.$$
$\mu=\{{\mu}_i\}_{i\in\mathcal{S}}$ --- вектор средних вероятностей появления ошибки в различных состояниях, a $M$ --- средняя вероятность появления ошибки в канале. Для эталонных плотностей $\rho_i$ должно также выполняться условие адаптированности к каналу:
$$\forall i\in \mathcal{S}, \forall l \in L_i :\;\;\; \rho_i(l)\leq \frac{1}{\delta_i \mu_i}\leq 1.$$

Поле Галуа $F_q$ --- алфавит наблюдаемых символов. $\mathbb{F}^\ast_q$ --- мультипликативная группа поля Галуа $\mathbb{F}_q$. $B=\{b_{i}(k)\}_{i \in \mathcal{S}, k \in \mathbb{F}^\ast_q}$ --- набор распределений вероятностей значений ошибки в состояниях, элемент которого $b_{i}(k)$ представляет собой вероятность наблюдать символ $k$ в состоянии $i$, т.е. можно записать в виде:
$$\forall i \in \mathcal{S},\forall k \in \mathbb{F}^\ast_q :$$
$$\;\;\; b_{i}(k)\triangleq P[k|S_{t}=i].$$
\end{definition}

Отметим, что для параметров СПМQP-модели должны дополнительно выполняться следующие два условия:
\begin{equation}
\label{eq_adopt}
\forall i \in \mathcal{S}, \forall d \in \mathcal{D}: \frac{1}{d \mu_i} \geq 1 \Rightarrow p_i(d)=0.
\end{equation}

\begin{equation}
\label{eq_soglas}
M =\sum\limits_{i \in \mathcal{S}}\mu_i P_i^{\mathrm{lim}},
\end{equation}
где $P_i^{\mathrm{lim}}$ --- предельные вероятности состояний.

Посредством описанной модели можно производить генерацию потоков ошибок. В нулевой момент времени (то есть до начала генерации последовательности ошибок) с помощью вектора $\Pi$ определяется состояние системы до наступления первого момента времени. Далее для каждого момента времени выполняется следующая последовательность действий:

1) На основе матрицы переходных вероятностей выбирается текущее состояние канала $i$.

2) С использованием распределения вероятностей длительностей $p_i(d)$ в выбранном состоянии определяется длина $d$ временного отрезка, на протяжении которого модель будет находиться в текущем состоянии (то есть длительность текущего состояния).

3) Для каждой точки отрезка выбранной длины вычисляется вероятность наличия в ней ошибки:
\begin{equation}
\label{eq_error_prob}
\forall \theta \in [1,d]: e_{i,\theta}^d = \varphi_i^d(\theta)\mu_i d,
\end{equation}
где
\begin{equation}
\label{eq_varphi}
\varphi_i^d(\theta) = \int\limits_{\theta}^{\theta+1} \varphi_{i,d}^{pc}(x)dx
\end{equation}
и
$$\forall l\in L_i: \;\;\;\;\; \varphi_{i,d}^{pc}\mid _{(lq,(l+1)q]}=\frac{\delta_i}{d}\cdot \rho(i),$$

где $q=\frac{d}{\delta_i}$. В соответствии с этой вероятностью определяется наличие ошибки на данной позиции.

4) В случае, если ошибка есть, в соответствии с матрицей $B$ генерируется ее значение. В противном случае, на этой позиции будет стоять нулевой элемент.

\textbf{5.} ...Построенная СПМQP-модель может быть рассмотрена в рамках общей скрытой полумарковской модели...частн случай, но не совсем...

... попробовать построить модель так, чтобы оговорить, что является частным случаем, а что новым. М.б. через модель Фергюссона (Маша сказала)

Для этого введем необходимые уточнения параметров общей скрытой полумарковской модели. Во-первых, в качестве алфавита наблюдаемых символов выбрано поле Галуа $\mathbb{F}_q$; во-вторых, допускается возможность самоперехода, то есть перехода из состояния $i (\in \mathcal{S})$ в него же; в-третьих, вероятность перехода в новое состояние зависит только от предыдущего состояния, а его длительность -- только от него самого, т.е.:
\begin{equation}
\label{eq_initial_alpha}
a_{(i,d)(i^\prime, d^\prime)}=a_{ii^\prime}p_{i^\prime}(d^\prime)
\end{equation}
и, аналогично,
\begin{equation}
\label{eq_initial_pi}
\pi_{i^\prime,d^\prime} = \pi_{i^\prime} p_{i^\prime} (d^\prime);
\end{equation}
в-четвертых, при фиксированном состоянии наблюдения независимы, а их вероятности зависят как от текущего состояния и его длительности, так и от позиции наблюдения внутри текущего временного отрезка;
в-пятых, предполагается условная независимость события, заключающегося в наблюдении в некоторый момент времени $t+1$ состояния $j$ с длительностью $d$, от события, заключающегося в наблюдении последовательности $O_{1:t}$, при условии, что в момент времени $t$ закончилось состояние $i$ длительностью $d^\prime$. По определению условной независимости можно записать:
\begin{equation}
\label{eq_cond_1}
\begin{split}
&P[S_{[t+1,t+d+1]}=j, O_{1:t}|S_{[t-d^\prime+1,t]}=i] \\
&= P[S_{[t+1,t+d+1]}=j|S_{[t-d^\prime+1,t]}=i]P[ O_{1:t}|S_{[t-d^\prime+1,t]}=i];
\end{split}
\end{equation}
в-шестых, предполагается условная независимость события, заключающегося в наблюдении последовательности $O_{t+1,t+d}$, от произведения событий наблюдения последовательности $O_{1:t}$ и окончания в момент времени $t$ состояния $i$ длительности $d^\prime$ при условии, что в момент времени $t+1$ началось состояние $j$ длительностью $d$. Таким образом из определения условной независимости следует, что:
\begin{equation}\label{eq_cond_2}
P[O_{t+1:t+d}|S_{[t+1,t+d+1]}=j, O_{1:t}, S_{[t-d^\prime+1,t]}=i] =
P[O_{t+1:t+d}|S_{[t+1,t+d+1]}=j].
\end{equation}

...Четко ответить на вопрос обо всех преимуществах построенной модели, включая и обратные задачи.
\subsection{Имитационная (компьютерная) модель} \label{sect2_1_4}

%\newpage
%============================================================================================================================
\section{Скрытая полумарковская модель типа Фергюсона.} \label{sect2_2}
В настоящее время теория скрытых марковских и полу-марковских моделей \cite{Rabiner}, \cite{Levinson}, \cite{Yu} получила широкое применение в различных прикладных областях таких как распознавание и синтез речи, распознавание изображений и рукописного текста, выявление аномалий в сети, анализ биологических последовательностей.
Актуальным является представление генераторов типа скрытых марковских и скрытых полу-марковских моделей полиномиальными структурами. Такое представление позволит реализовывать генераторы посредством программируемых логических
интегральных схем, что значительно увеличит эффективность реализации.
Использование полей Галуа вида $F_{2^n}$ представляется удобным для этих целей в виду известных достоинств алгоритмов вычислений в них, таких, например, как возможность построения параллельной реализации.

Представлению конечных однородных цепей Маркова и некоторых типов автономных вероятностных автоматов полиномиальными функциями над полями Галуа посвящены работы \cite{Nurutdinov}, \cite{ZahNurSokShal}. В частности в работе \cite{ZahNurSokShal} предлагается полиномиальное представление автомата, представляющего собой скрытую марковскую модель \cite{Rabiner}.

В настоящем разделе ставится задача построения полиномиальной модели частного случая скрытой полу-марковской модели - скрытой марковской модели с явно заданной функцией плотности длительности состояний \cite{Rabiner}.


\subsection{Определение скрытой полумарковской модели типа Фергюсона.}
Описываемая в этом разделе модель была впервые предложена Фергюсоном в [ссылка на Фергюсона] и носила название скрытой марковской модели с изменяющейся длительностью (HMM with variable duration). В более поздних работах \cite{Rabiner}, [Ю Кобаяши] она получила название скрытой марковской модели с явно заданной плотностью длительности состояний (Explicit duration HMM). Однако, мы будем для краткости называть ее в дальнейшем скрытой полумарковской моделью фергюсоновского типа.

\begin{definition}Скрытой полумарковской моделью фергюсоновского типа будем называть систему:
\begin{equation}\label{eq:2.2.2:model}\Delta =\{S,A,\pi,V,B,D,F\},	\end{equation}
где
1) $S=\{S_1,S_2,...,S_N\}$ --- алфавит состояний модели;

2) $A=\{a_ij\}_{i,j=1}^N$ – матрица переходов;

3) $\pi=\{\pi_i \}_{i=1}^N$ – вектор начального распределения вероятностей состояний;

4) $V=\{v_1,v_2,...,v_M\}$ – алфавит наблюдаемых символов;

5) $B=\{b_ij\}_{i,j=1}^{N,M}$– матрица условных вероятностей наблюдения символа $v_j$ в состоянии $S_i$;

6) $D$ – алфавит возможных длительностей мощности $L$;

7) $F=\{f_ij\}_{i,j=1}^{N,L}$ – матрица размера $N\times L$, элемент $f_ij$  которой представляет собой вероятность наблюдать длительность $d_j$ при условии, что $\Delta$ находится в состоянии $S_i$.
\end{definition}

%\begin{remark} В литературных источниках скрытая полумарковская модель типа Фергюсона носит название скрытой марковской модели с явно заданной функцией плотности длительности состояний (explicit duration HMM).
%\end{remark}

%Модель (\ref{eq:2.2.2:model}) представляет собой общую скрытую полумарковскую модель из работы \cite{Yu} с наложенными на нее следующими дополнительными ограничениями: текущее состояние зависит только от предшествующего; текущая длительность определяется только текущим состоянием; наблюдения символов выходного алфавита внутри длительности полагаются условно независимыми с распределением вероятностей, зависящим только от текущего состояния, но не от его длительности. Отметим также, что если алфавит возможных длительностей содержит только один элемент и, следовательно, матрица $F$ представляет собой вектор длины $N$, все элементы которого равны $1$, то скрытая полумарковская модель типа Фергюсона сводится к скрытой марковской модели. Приведем следующий пример скрытой полумарковской модели типа Фергюсона.

\begin{example}Рассмотрим симметричный стационарный идеально синхронизированный цифровой канал передачи данных C, по которому передается информация в виде последовательностей символов $q$-ичного алфавита, отождествляемого с полем Галуа $F_q$. Канал $C$ может находиться в одном из $N$ различных физических состояний в течение некоторого промежутка времени, после чего переходит в следующее состояние. Предполагается, что для произвольного состояния распределение длительностей пребывания в нем фиксировано. В каждом из состояний могут возникать независимые аддитивные ошибки с собственным фиксированным распределением. Покажем, что источник ошибок в рассмотренном канале передачи данных C может быть описан скрытой полумарковской моделью фергюсоновского типа. Действительно, набору физических состояний канала поставим в соответствие алфавит $S=\{S_1,S_2,…,S_N \}$, вероятности переходов между состояниями зададим матрицей $A=\{a_ij\}_(i,j=1)^N$, начальное распределение вероятностей состояний определим вектором $\pi=\{\pi_i\}_{i=1}^N$. Пусть $D$ – множество всех возможных длительностей по всем состояниям, а элемент $f_ij$ матрицы $F=\{f_ij\}_{i,j=1}^{N,L}$– вероятность наблюдения длительности $d_j$ при условии, что канал передачи данных C находится в состоянии $S_i$. В качестве выходного алфавита $V$ модели источника ошибок в канале $C$ выступает алфавит канала, а вероятности наблюдения различных значений ошибки в различных состояниях канала задаются в виде матрицы $B=\{b_ij\}_{i,j=1}^{N,q}$.
\end{example}

Модель (\ref{eq:2.2.2:model}) представляет собой общую скрытую полумарковскую модель из работы \cite{Yu} с наложенными на нее следующими дополнительными ограничениями:

1) текущее состояние не зависит от длительности предыдущего состояния;

2) текущая длительность определяется только текущим состоянием и не зависит от предыдущего состояния и его длительности;

3) наблюдения символов выходного алфавита внутри длительности полагаются условно независимыми с распределением вероятностей, зависящим только от текущего состояния, но не от его длительности.

Ограничения 1) -- 2) можно записать в виде:
\begin{equation}\label{eq_2.3.1_1} a_{(i,d)(j,d^\prime)}= a_{ij}\cdot p_j(d^\prime), \;\;\; a_{ii}=0,\end{equation}
где $a_{ij}=P[S_{[t=j}|S_{t-1]=i}]$, а ограничение 3):
\begin{equation}\label{eq_2.3.1_2}b_{j,d}(O_{t+1:t+d})=\prod\limits_{\tau=t+1}^{t+d}b_j(O_\tau).\end{equation}

Отметим также, что если алфавит возможных длительностей содержит только один элемент и, следовательно, матрица $F$ представляет собой вектор длины $N$, все элементы которого равны $1$, то скрытая полумарковская модель типа Фергюсона сводится к скрытой марковской модели.

Процесс генерирования последовательности наблюдений посредством модели Фергюсона выглядит следующим образом.

 \textbf{Этап 1.} Как и в случае обыкновенной СММ, в соответствии либо с вектором $\pi$ (в момент времени $t=1$ ), либо с матрицей $A$ выбирается текущее состояние.

 \textbf{Этап 2.} В выбранном состоянии $S_i$ с использованием $p_i(d)$ определяется длина временного промежутка, в течение которого система будет находиться в $i$-ом состоянии

 \textbf{Этап 3.} В каждой точке этого отрезка посредством $b_i(k)$ генерируется наблюдение.

\subsection{Вспомогательные результаты о полиномиальном представлении одного класса стохастических матриц.}
В работах \cite{Nurutdinov},  \cite{ZahNurSokShal} были построены полиномиальные модели для некоторых типов вероятностных автоматов, в частности, автоматов, реализующих простую однородную цепь Маркова и скрытую марковскую модель. В основе построения полиномиальных моделей лежит сопоставление переходной и, в случае скрытой марковской модели, выходной матрице полинома от двух переменных. В этом разделе опишем принцип, позволяющий по абстрактной прямоугольной стохастической по строкам матрице построить полином двух переменных над полем Галуа $F_{2^n}$.
Пусть $X$, $Y$ – конечные множества элементарных событий. Рассмотрим прямоугольную стохастическую по строкам матрицу $P$ размера $|X|\times|Y|$, составленную из условных вероятностей
$$P=\left(
      \begin{array}{ccc}
        P(y_1|x_1) & \ldots & P(y_{|Y|}|x_1) \\
        \vdots & \ddots & \vdots \\
        P(y_1 |x_{|X|}) & \ldots & P(y_{|Y|}|x_{|X|} ) \\
      \end{array}
    \right)
$$
где
$$\forall i\in [1,|X|]:x_i\in X, \forall j\in[1,|Y|]:y_j\in Y.$$
Каждая стохастическая по строкам матрица размера $n\times m$ может быть представлена как выпуклая линейная комбинация не более чем $n(m-1)+1$ простых матриц (см. \cite{ZahNurSokShal} и \cite{Pospelov}, с. 26). (Стохастические матрицы, в которых все элементы нули и единицы, называются простыми \cite{Pospelov}, с. 26). Поэтому:
\begin{equation}  \label{eq:2.2.1:general_expansion} P=\sum\limits{k=1}^l_P p_k^P M^P(u_k^P), \;\; l_P\leq |X|(|Y|-1)+1,\end{equation}
где для любого $k\in[1,l_P]$
\begin{equation}  \label{eq:2.2.1:general_simple_matrix} M^P (u_k^P )={\mu_ij^P (u_k^P)}_{i,j=1}^{|X|,|Y|}\end{equation}		                 – простая матрица размера $|X|\times|Y|$ и выполняется условие:
$$0\leq p_k^P\leq1 ,\;\;\; \sum\limits_{k=1}^{l_P}p_k^P =1.$$
По (\ref{eq:2.2.1:general_expansion}) построим случайную величину $u^P$, принимающую значения на множестве $U^P$, где $|U^P|=l_P$, и распределенную по следующему закону:
$$\begin{tabular}{c|c|c|c}
    $u_1^P$ & $u_2^P$ & \ldots & $u_{l_P}^P$ \\
        \hline
    $p_1^P$& $p_2^P$ & \ldots & $p_{l_P}^P$ \\
  \end{tabular}
$$
Обозначим
\begin{equation}
\label{eq:2.2.1:general_Phi}
\Phi^P (P)=u^P.
\end{equation}
Теперь, используя случайную величину $u^P$ и представление (\ref{eq:2.2.1:general_expansion}), определим по простой матрице (\ref{eq:2.2.1:general_simple_matrix}) отображение $\lambda^P:U^P\times X\rightarrow Y$, для которого $\lambda^P (u^P,x_i)=y_j$ при $\mu_ij^P (u^P)=1$.

Опишем принцип построения по отображению $\lambda^P$ многочлена двух переменных над полем Галуа \cite{Nurutdinov}. Зададим минимальное натуральное $n$, для которого
$$2^n\geq max\{l_P,|X|,|Y|\},$$
и установим взаимно-однозначные соответствия между элементами каждого из множеств $U^P$,$X$,$Y$ и элементами поля Галуа $F_{2^n}$. Обозначим отображение, определенное на $F_{2^n}\times F_{2^n}$ и соответствующее $\lambda^P$, через
$\hat{\lambda}^P:F_{2^n}\times F_{2^n}\rightarrow F_{2^n}$.
Соответствие понимается в том смысле, что на $\hat{x},\hat{y}\in F_{2^n}$, кодирующих $x\in X$,$y\in Y$, функция $\hat{\lambda}^P (\hat{x},\hat{y})$ принимает значение, кодирующее $\lambda^P (x,y)$. Известно, что для произвольного отображения $\varphi:F_{2^n}\times F_{2^n}\rightarrow F_{2^n}$ существует единственный полином вида
\begin{equation}  \label{eq:2.2.1:general_polinom} f(x,q)=\sum\limits{i,j=0}^r h_ij x^j q^i,\;\;\; r=2^n-1,\end{equation}
где $x,q,h_ij\in F_{2^n}$, являющийся представлением отображения $\varphi$ в том смысле, что $f(c_1,c_2)=\varphi(c_1,c_2)$ для всех $c_1,c_2\in F_{2^n}$; матрица коэффициентов многочлена (\ref{eq:2.2.1:general_polinom}) определяется из следующего соотношения:
$$H=C^{-1} Z(C^{-1} )^T,$$
где $Z={z_ij }_(i,j=0)^(r-1)$   – матрица значений отображения $\varphi$ на элементах поля $F_{2^n}$ и
\[C^{-1}=\left(
  \begin{array}{ccccccc}
    1 & 0 & 0 & \ldots & 0 & \ldots & 0 \\
    0 & 1 & \xi^{r-1} & \ldots & \xi^{(r-1)i mod(r)} & \ldots & \xi \\
    \ldots & \ldots & \ldots & \ldots & \ldots & \ldots & \ldots \\
    0 & 1 & \xi^2 & \ldots & \xi^{2i mod(r)} & \ldots & \xi^{r-2} \\
    0 & 1 & \xi & \ldots & \xi^i & \ldots & \xi^{r-1} \\
    1 & 1 &1 & \ldots & 1 & \ldots & 1 \\
  \end{array},
\right)\]
где $r=2^n-1$, $1\leq i\leq r-1$, $\xi$ – примитивный элемент $F_{2^n}$ (см. \cite{Nurutdinov}). Таким образом, зная значения отображения $\hat{\lambda}^P$ в точках $F_{2^n}\times F_{2^n}$, можно построить многочлен $f_P (x_P,q_P )=\sum\limits_{i,j=0}^r h_ij^P x_P^j q_P^i$, где на вход полинома в качестве значений переменной $x_P$ подается элемент поля, соответствующий реализации случайной величины $u^P$, а в качестве $q_P$ – элемент поля, соответствующий $x_i$.

\subsection{Структурная схема и полиномиальное представление скрытой полумарковской модели типа Фергюсона.}
Для скрытой полумарковской модели фергюсоновского типа построим полиномиальное представление. Для этого по каждой из матриц $A$,$B$ и $F$ определим полином так, как это было сделано в предыдущем разделе для абстрактной прямоугольной матрицы. Итак, поскольку матрицы $A$,$B$ и $F$ являются стохастическими по строкам, согласно \cite{ZahNurSokShal}, \cite{Pospelov}, они могут быть представлены в виде выпуклых линейных комбинаций простых матриц:
\begin{equation}\label{eq:2.2.2:expansion_A}
A=\sum\limits_{k=1}^{l_A}p_k^A  M^A (u_k^A ), \;\; l_A\leq N^2-N+1,
\end{equation}
\begin{equation}\label{eq:2.2.2:expansion_B}
B=\sum\limits_{k=1}^{l_B}p_k^B  M^B (u_k^B ), \;\; l_B\leq N(M-1)+1,	
\end{equation}
\begin{equation}\label{eq:2.2.2:expansion_F}
F=\sum\limits_{k=1}^{l_F}p_k^F  M^F (u_k^F ), \;\; l_F\leq N(L-1)+1,
\end{equation}
где
$M^A (u_k )=\{\mu_ij^A (u_k^A)\}_{i,j=1}^{N,N}$, $M^B (u_k)=\{\mu_ij^B (u_k^B)\}_{i,j=1}^{N,M}$, $M^F (u_k)=\{\mu_ij^F (u_k^F)\}_{i,j=1}^{N,L}$
– простые матрицы размеров $N\times N$, $N\times M$, $N\times L$ соответственно, причем
$$0\leq p_k^A\leq 1,  \sum\limits_{k=1}^{l_A}p_k^A =1,$$
$$0\leq p_k^B\leq 1 ,  \sum\limits_{k=1}^{l_B}p_k^B =1,$$
$$0\leq p_k^F\leq 1,  \sum\limits_{k=1}^{l_F}-p_k^F =1.$$
Используя (\ref{eq:2.2.2:expansion_A}), построим отображение $\Phi^A$ типа (\ref{eq:2.2.1:general_Phi}), ставящее в соответствие матрице $A$ такую случайную величину $u^A$, которая принимает значения на некотором множестве $U^A$ с $|U^A |=l_A$, и распределенную по следующему закону:
$$\begin{tabular}{c|c|c|c}
    $u_1^A$ & $u_2^A$ & \ldots & $u_{l_A}^A$ \\
        \hline
    $p_1^A$& $p_2^A$ & \ldots & $p_{l_A}^A$ \\
  \end{tabular}
$$
Определим отображение $\lambda^A:U^A\times S\rightarrow S$, такое что $\lambda^A (u^A,S_i)=S_j$, если $\mu_ij^A (u^A)=1$.

Применяя рассуждения, аналогичные вышеприведенным, по разложениям (\ref{eq:2.2.2:expansion_B}) и (\ref{eq:2.2.2:expansion_F}) определим соответственно отображения $\Phi^B$ и $\Phi^F$, случайные величины $u^B$ со значениями из множества $U^B$ ($|U^B |$=$l_B$) и $u^F$ со значениями из множества $U^F$ ($|U^F|=l_F$), распределенные по следующим законам:
$$\begin{tabular}{c|c|c|c}
    $u_1^B$ & $u_2^B$ & \ldots & $u_{l_B}^B$ \\
        \hline
    $p_1^B$& $p_2^B$ & \ldots & $p_{l_B}^B$ \\
  \end{tabular},
$$
$$\begin{tabular}{c|c|c|c}
    $u_1^F$ & $u_2^F$ & \ldots & $u_{l_F}^F$ \\
        \hline
    $p_1^F$& $p_2^F$ & \ldots & $p_{l_F}^F$ \\
  \end{tabular}
$$
Далее по (\ref{eq:2.2.2:expansion_B}) построим отображение $\lambda^B:U^B\times S\rightarrow V$, такое что $\lambda^B (u^B,S_i)=v_j$, при $\mu_ij^B (u^B)=1$. В свою очередь по (\ref{eq:2.2.2:expansion_F}) определим отображение $\lambda^F:U^F\times S\rightarrow D$ такое, что  $\lambda^F (u^F,S_i)=d_j$, при $\mu_ij^F (u^F)=1$.
Установим соответствие между элементами множеств $U^A$, $U^B$, $U^F$, $S$, $V$, $D$ и элементами поля Галуа: выберем минимальное натуральное $n$, для которого
$$2^n\geq max\{l_A,l_B,l_F,N,M,L\}$$
и закодируем элементы множеств $U^A$, $U^B$, $U^F$, $S$, $D$, $V$ элементами поля $F_{2^n}$. Согласно предыдущему разделу для каждого из отображений $\hat{\lambda}^A$,$\hat{\lambda}^B$ и $\hat{\lambda}^F$, действующих из $F_{2^n}\times F_{2^n}$ в $F_{2^n}$ и кодирующих $\lambda^A$,$\lambda^B$ и $\lambda^F$, можно построить единственный полином вида (\ref{eq:2.2.1:general_polinom}). Обозначим эти полиномы $f_A (x_A,q_A)$, $f_B (x_B,q_B)$ и $f_F (x_F,q_F)$ соответственно.
Полиномиальной моделью скрытой полумарковской модели типа Фергюсона назовем систему
$$\Pi M=(u^A,u^B,u^F,f_B (x_B,f_A (x_A,q_A )),f_F (x_F,f_A (x_A,q_A )),\pi),$$
в которой $u^A$,$u^B$ и $u^F$ – случайные величины, определяемые по разложениям матриц $A$, $B$ и $F$ на линейные комбинации простых матриц аналогично (\ref{eq:2.2.1:general_expansion}), значения которых закодированы элементами поля $F_{2^n}$.
Структурная схема автомата, реализующего полиномиальное представление скрытой полумарковской модели фергюсоновского типа $\Delta$, представлена на рисунке 1.

\begin{center}
  \includegraphics[height=100mm]{/part2/Structural_model.jpg}
%TODO:Сделать рисунок в pdf формате

  Рис.1. Структурная схема автомата, реализующего полиномиальное представление скрытой полумарковской модели типа Фергюсона.
  \end{center}

В схеме можно выделить шесть основных блоков, а именно укрупненные блоки «$A$», «$B$», «$F$», соответствующие матрицам $A$,$B$,$F$ модели $Delta$ (см. (\ref{eq:2.2.2:model})); управляющий «Блок $Y$» и вспомогательные блоки: «Блок задержки 1», «Блок задержки 2». Укрупненный «Блок $A$», состоящий из генератора случайной величины $u^A$ «ГСВ $u^A$» и блока $f_A (x_A,q_A)$, отвечает за генерацию текущего состояния модели. Укрупненный «Блок $F$» состоит из генератора случайной величины $u^F$ «ГСВ $u^F$» и блока $f_F (x_F,q_F)$, производит генерацию длительности в выбранном состоянии и тем самым определяет количество запусков укрупненного «Блока $B$». Укрупненный «Блок $B$» состоит из генератора случайной величины $u^B$ «ГСВ $u^B$» и блока $f_B (x_B,q_B)$ и возвращает на выходе символ.
Опишем работу автомата. Блок «ГСВ $u^A$» генерирует значение случайной величины $u^A$ в соответствии с распределением. Сгенерированное значение подается на вход блока $f_A (x_A,q_A)$ в качестве $x_A$, а в качестве $q_A$ подается элемент поля $F_{2^n}$, соответствующий текущему состоянию, в первый момент времени определяемому по вектору $\pi$. Значение полинома $f_A (x_A,q_A)$, представляющее собой новое состояние автомата, подается на вход блока $f_F (x_F,q_F)$ в качестве переменной $q_F$, а также «Блока задержки 1» и «Блока задержки 2». Одновременно с этим блок «ГСВ $u^F$» генерирует значение случайной величины $u^F$ в соответствии со своим распределением. Это значение поступает на вход полинома $f_F (x_F,q_F)$ в качестве $x_F$, а на выходе получается длительность $d$, которая подается на вход управляющего блока «$Y$» и определяет текущее число запусков укрупненного «Блока $B$». «Блок задержки 2» выполняет задержку выходного сигнала блока $f_A (x_A,q_A)$ так, чтобы он поступил на вход блока «$Y$» после того, как отработает блок $f_F (x_F,q_F)$. «Блок $Y$» передает выход блока $f_A (x_A,q_A)$ в качестве переменной $q_B$ подблока $f_B (x_B,q_B)$ укрупненного блока «$B$», а в качестве $x_B$ подается реализация случайной величины $u^B$, сгенерированная собственным генератором в соответствии с распределением. На выходе «$B$» выдает символ $\tilde{v}_i$. Отметим, что укрупненный «Блок B» запускается не один, а $d$ раз, и его запуски управляются блоком «$Y$». Таким образом, текущее состояние порождает последовательность выходных символов длины $d$. «Блок задержки 1» выполняет задержку выходного сигнала блока $f_A (x_A,q_A)$ так, чтобы он поступил на вход $f_A (x_A,q_A)$ после того, как $d$ раз отработает укрупненный «Блок $B$».

%\begin{center}
%\textbf{Сведения о марковских цепях, вероятностных автоматах и полиномах.
%}\end{center}
%Приведем необходимые сведения из теории вероятностных автоматов и теории цепей Маркова.
%
%\textbf{Определение 0.} \emph{автономного вероятного автомата.}
%
%\textbf{Определение 0.} \emph{автономного вероятного автомата без выхода.}
%
%\textbf{Определение 1.} \emph{Конечной однородной цепью Маркова} назовем тройку
%$$\Gamma = (S, P, \pi),$$
%где $S=\{S_1, S_2, ..., S_N \}$ --- алфавит состояний цепи Маркова;
%$P=\{p_{ij}\}_{i,j=1}^{N}$ --- стохастическая матрица размера $N\times N$, называемая матрицей переходных вероятностей;
%$\pi=\{\pi_i\}_{i=1}^{N}$ --- вектор начального распределения вероятностей состояний.
%
%В работе \cite{ZahNurShal} предлагается структурная схема конечной однородной Марковской цепи как вероятностного автомата без выхода (Рис. 1).
%
%\begin{center}
%  \includegraphics[height=40mm]{/part2/struct0.pdf}
%
%  Рис.1.Структурная схема конечной однородной Марковской цепи.
%  \end{center}
%
%Блок ГСВ выполняет функцию генератора случайной величины $Q$, а функция переходов $\lambda(q,s)$ строится следующим образом. По теореме  о  представлении квадратной стохастической матрицы выпуклой линейной комбинацией простых матриц (см. \cite{Bukharaev} c. 25, \cite{Poselov} c.26) матрица $P$ может быть представлена в виде:
%$$P=\sum \limits_{k=1}^{l_s} p_k M(q_k),\;\;\; l_s\leq N^2-N+1, $$
%где $M(q_k)$ --- простая матрица размера $N\times N$. Определим отображение $\lambda : Q\times S\rightarrow S$ такое что $\lambda(q,s_i)=s_j,$ если в матрице $M(q)$ на позиции $i,j$ стоит 1, т. е. $\pi_{ij}=1$.($q$ --- случайная величина, $M(q)=\{\pi_{ij}\}_{i,j=1}^{N,N}$).
%
%Имеет место лемма \cite{Nurutdinov}.
%
%\textbf{Лемма.} Пусть $G=F_{2^n}$, а $\varphi:G\times G\longrightarrow G$ --- произвольная функция от двух переменных, отображающая $G\times G$ в $G$, тогда существует единственный полином вида
%\begin{equation}\label{eq_pol}
%f(x,q)=\sum\limits_{i,j=0}^r a_{ij} x^j q^i, \;\; r=2^n-1,
%\end{equation}
%где $x,q,a_{ij}\in G, n$ определяется условием $l\leq 2^n-1$, являющийся представлением отображения $\varphi$ в том смысле, что $f(c,d)=\varphi(c,d)$ для всех $c,d\in G\times G$.
%
%Матрица коэффициентов многочлена \ref{eq_pol} определяется из следующего соотношения:
%$$A=C^{-1}Y(C^{-1})^T,$$
%где $Y=\{y_{ij}\}_{i,j=0}^{r-1}$ матрица значений отображения $\varphi$ на элементах поля $G$, а $C^{-1}$ имеет следующий вид \cite{Nurutdinov}:
%
%\begin{equation}C^{-1}=
%\left(
%  \begin{array}{ccccccc}
%    1 & 0 & 0 & ... & 0 & ... & 0 \\
%    0 & 1 & \xi^{r-1} & ... & \xi^{(r-1)i mod (r)} & ... & \xi \\
%    ... & ... & ... & ... & ... & ... & ... \\
%    0 & 1 & \xi^2 & ... & \xi^{2 i mod (r)} & ...& \xi^{r-2} \\
%    0 & 1 & \xi & ... & \xi^{i} & ...& \xi^{r-1} \\
%    1 & 1 & 1 & ... & 1 & ... & 1 \\
%  \end{array}
%\right)
%\end{equation}
%где $r=2^n-1, 1\leq i\leq r-1$, $\xi$ --- примитивный элемент $G$.
%
%В работе \cite{Nurutdinov} предлагается представление функции $\lambda(q,s)$ полиномом над полем $F_{2^n}$. Сформулируем следующую теорему из \cite{Nurutdinov}.
%
%\textbf{Теорема.} Пусть $G=F_{2^n}$ и заданы
%$$f(x,q)=\sum \limits_{i,j=0}^r a_{ij}x^j q^i, \;\; r=2^n-1, a_{ij},x,q\in G,$$
%с множеством $\{x_i\}, i=1,...,l,$ значений переменной $x$ и множеством $\{q_j\}, j=1,...,m$ значений переменной $q$, случайная величина $\hat{\mu}$ с множеством значений $\{\mu_i\}\subset \{x_i\}$ и со стохастическим вектором $\bar{P}$ и вектор $\pi_0$.
%
%Тогда последовательность вычисленных значений полинома $f(x,q)$ является реализацией простой однородной цепи Маркова с множеством состояний $\{q_j\}$, описываемой стохастической матрицей $P$ размера $|\{q_j\}|$, элементы которой однозначно определяются вектором $\bar{P}$ и полиномом $f(x,q)$.
%
%%\emph{Лемма и вывод коэффициентов для s-переменных.}
%
%\begin{center}
%\textbf{Структурная схема и полиномиальное представление скрытой марковской модели.
%}\end{center}
%Скрытой марковской моделью, следуя Рабинеру \cite{Rabiner}, будем называть пятерку: $$\lambda=(S, V, A, B,\pi),$$
%где
%$S=\{S_1, S_2, ..., S_N \}$ --- алфавит состояний;
%$A=\{a_{ij}\}_{i,j=1}^{N}$ --- матрица переходных вероятностей,
%где $a_{ij} = P[q_t=S_j|q_{t-1}=S_i]$, $q_t$ -- состояние модели в момент $t$;
% $\pi=\{\pi_i\}_{i=1}^{N}$ --- вектор начального распределения вероятностей состояний, где $\pi_i=P[q_1=S_i]$;
%  $V=\{v_1,v_2,...,v_M \}$ --- алфавит наблюдаемых символов;
%  $B=\{b_{ij}\}_{i,j=1}^{N, M}$ --- матрица распределений вероятностей появления наблюдаемых символов, где $b_{jk}=b_j(k) = P[r_t= v_k | q_t = S_j]$, $r_t$ -- символ, наблюдаемый в момент времени $t$.
%
%  Скрытая марковская модель представляет собой автономный вероятностный автомат с выходом следующего вида \cite{ZahNurShal}:
%  \begin{equation}
%  \label{eq_PAwithOutput}
%  A=(S, A, \pi, V, \mu),\;\;\;
%  \end{equation}
%  где
%$S=\{S_1, S_2, ..., S_N \}$ --- конечное множество состояний;
%$A$ --- стохастическая матрица размера $N\times N$;
%$\pi$ --- n-мерный стохастический вектор, задающий начальное распределение вероятностей состояний;
%$V=\{v_1,v_2,...,v_M \}$ --- конечный выходной алфавит;
%$\mu$ ---функция выхода, задаваемая стохастической матрицей $B=\{b_{ij}\}_{i,j=1}^{N, M}$  размера $N\times M$,
%где элемент $b_{ij}$ определяет вероятность появления буквы $v_j$ при условии, что $A$ находится в состоянии $s_i$.
%
%Рассмотрим структурную модель описанного автономного вероятностного автомата. Будем использовать подход структурного синтеза вероятностного автомата, основанный на представлении вероятностного автомата в виде последовательностной композиции управляемого генератора дискретной случайной величины и конечного детерминированного автомата\cite{ZahNurShal}.
%
%Для представления автомата структурной моделью по теореме о представлении квадратной стохастической матрицы выпуклой линейной комбинацией простых матриц (см. например \cite{Bukharaev},c. 26) записываем матрицу $A$ в виде:
%$$A=\sum \limits_{k=1}^{l_s} p_k M(q_k),\;\;\; l_s\leq N^2-N+1, $$
%$M(q_k)$ --- простая матрица размера $N\times N$. Определим отображение $\lambda : Q\times S\rightarrow S$ такое что $\lambda(q,s_i)=s_j,$ если в матрице $M(q)$ на позиции $i,j$ стоит 1, т. е. $\pi_{ij}=1$.($q$---случайная величина, $M(q)=\{\pi_{ij}\}_{i,j=1}^{N,N}$).
%
%По аналогии по теореме о представлении прямоугольной стохастической матрицы выпуклой линейной комбинацией простых матриц представим
%$$B=\sum \limits_{k=1}^{l_v} p^\prime_k M^\prime(q^\prime_k),\;\;\; l_v\leq N(M-1), $$
%$M^\prime(q_k)$ --- простая матрица размера $N\times M$. Определим отображение $\delta : Q\times S\rightarrow S$ такое что $\delta(q^\prime,s_i)=v_j,$ если в матрице $M^\prime(q^\prime)$ на позиции $i,j$ стоит 1, т. е. $\pi^\prime_{ij}=1$.($q^\prime$---случайная величина, $M^\prime(q^\prime)=\{\pi^\prime_{ij}\}_{i,j=1}^{N,M}$).
%
%Таким образом можно представить автономный вероятностный автомат $A$ структурной схемой, изображенной на рисунке 3.
%
%\begin{center}
%  \includegraphics[height=50mm]{/part2/struct.pdf}
%
%  Рис.3. Структурная схема автономного вероятностного автомата, соответствующего скрытой марковской модели.
%  \end{center}
%  Работа такой схемы происходит следующим образом. Генератор случайной величины $Q$ генерирует дискретную случайную величину
%
%  \begin{center}
%  \begin{tabular}{l|c|c|r}
%    $q_1$ &$ q_2$ & ... & $q_{l_s}$ \\
%    \hline
%    $p_1$ & $p_2$ & ... & $p_{l_s}$ \\
%  \end{tabular}
%    \end{center}
%   Значения $q_k$, $k=\overline{1,l_s}$ поступают на вход блока $\lambda$ с вероятностями $q_k$. Блок реализует функцию перехода между состояниями, которая задается по матрице $M(q_k)$ как было рассмотрено выше. Далее генератор случайной величины $Q^\prime$ генерирует дискретную случайную величину
%
%  \begin{center}
%  \begin{tabular}{l|c|c|r}
%    $q^\prime_1$ &$ q^\prime_2$ & ... & $q^\prime_{l_s}$ \\
%    \hline
%    $p^\prime_1$ & $p^\prime_2$ & ... & $p^\prime_{l_s}$ \\
%  \end{tabular}
%    \end{center}
%значения которой $q^\prime_k$, $k=\overline{1,l_s}$ поступают на вход блока $\delta$ с вероятностями $q^\prime_k$. Блок реализует функцию выхода, которая задается по матрице $M(q^\prime_k)$ как было рассмотрено выше.
%
%Применяя лемму из раздела 1 можем представить функции $\lambda(q,s)$ и $\delta(q^\prime,s)$ в виде полиномов. Выберем наименьшее $n$ так, чтобы выполнялось: $2^n\geq \mid Q\mid$, $2^n\geq \mid Q^\prime\mid$, $2^n\geq \mid S\mid$. Элементы множеств $Q, Q^\prime, S$ закодируем элементами поля $G=F_{2^n}$. Получим, что отображения $\lambda(q,s)$ и $\delta(q^\prime,s)$ определены на $G\times G$ со значениями в $G$ и могут быть представлены полиномами вида \ref{eq_pol}.Таким образом задание скрытой марковской модели эквивалентно заданию последовательностной комбинации двух полиномов над полем $G$.
%
%\textbf{Теорема \cite{ZahNurSokShal}}
%Последовательность состояний процесса, заданного \ref{eq_PAwithOutput}, можно представить последовательностью значений функций $\psi=f_2\bullet f_1$ --- суперпозиции двух полиномов вида (\ref{eq_pol}) над полем $GF(2^n),$ где $n$ --- наименьшее целое, удовлетворяющее условию $2^n\geq max(l_s,l_v)$.
%
%
%\begin{center}
%\textbf{Структурная схема и полиномиальное представление скрытой полу-марковской модели.}
%\end{center}
%
%Рассмотрим частный случай общей скрытой полу-марковской модели, предложенной Ю в \cite{Yu}, так называемую скрытую марковскую модель с явно заданной функцией плотности длительности состояний \cite{Rabiner}.
%
%Скрытой марковской моделью с явно заданной функцией плотности длительности состояний будем называть семерку:
%\begin{equation}
%\label{EDHMM}
%\lambda = \{S, A, \pi, V, B, D, F\},
%\end{equation}
%где первые 5 параметров аналогичны параметрам скрытой марковской марковской модели, $D=\{d_i\}_{i=1}^L$ - алфавит возможных длительностей мощности $L$, а матрица $F$ размера $N\times L$ имеет следующий вид:
%
%$$F=
%        \left(\begin{array}{cccc}
%           P(d_1|S_1) & P(d_2|S_1) & \ldots & P(d_L|S_1) \\
%           P(d_1|S_2) & P(d_2|S_2) & \ldots & P(d_L|S_2) \\
%           \vdots & \vdots & \ddots & \vdots \\
%           P(d_1|S_N) &P(d_2|S_N) & \ldots &P(d_L|S_N)
%        \end{array}\right),$$
%где элемент $f_{ij}$ определяет вероятность выбора длительности $d_j$ при условии, что $\lambda$ находится в состоянии $S_i$.
%
%Отметим, что матрица $F$ является стохастической по строкам (элементы неотрицательны и сумма элементов каждой строки равна 1 \cite{Prasolov}, с. 355). Тогда она может быть представлена в виде выпуклой линейной комбинации не более чем $l_d$ простых матриц:
%$$F=\sum \limits_{k=1}^{l_d} p^d_k M^d(q^d_k),\;\;\; l_d\leq N(L-1), $$
%$M^d(q^d_k)$ --- простая матрица размера $N\times L$. Определим отображение $\gamma : Q^d\times S\rightarrow D$ такое что $\gamma(q^d,s_i)=d_j,$ если в матрице $M^d(q^d)$ на позиции $i,j$ стоит 1, т. е. $\pi^d_{ij}=1$.($q^d$---случайная величина, $M^d(q^d)=\{\pi^d_{ij}\}_{i,j=1}^{N,L}$).
%
%Структурная схема автомата, соответствующего скрытой марковской модели с явно заданной функцией плотности длительности состояний, представлена на рисунке 4 \begin{center}
%  \includegraphics[height=70mm]{/part2/struct3.pdf}
%
%  Рис.4. Структурная схема автомата, соответствующего скрытой марковской модели с явно заданной функцией плотности длительности состояний.
%  \end{center}
%
%Опишем работу такого автомата. Как и в случае скрытой марковской модели генератор случайной величины $Q^s$ генерирует дискретную случайную величину
%
%  \begin{center}
%  \begin{tabular}{l|c|c|r}
%    $q^s_1$ &$ q^s_2$ & ... & $q^s_{l_s}$ \\
%    \hline
%    $p^s_1$ & $p^s_2$ & ... & $p^s_{l_s}$ \\
%  \end{tabular}
%    \end{center}
%   Значения $q^s_k$, $k=\overline{1,l_s}$ поступают на вход блока $\lambda$. Блок реализует функцию перехода между состояниями, которая задается по матрице $M^s(q^s_k)$ как было рассмотрено выше.
%   Далее генератор случайной величины $Q^d$ генерирует дискретную случайную величину
%
%  \begin{center}
%  \begin{tabular}{l|c|c|r}
%    $q^d_1$ &$ q^d_2$ & ... & $q^d_{l_d}$ \\
%    \hline
%    $p^d_1$ & $p^d_2$ & ... & $p^d_{l_d}$ \\
%  \end{tabular}
%    \end{center}
%значения которой $q^d_k$, $k=\overline{1,l_d}$ поступают на вход блока $\gamma$. Блок реализует выбор длительности состояния $s$, которая задается по матрице $M(q^d_k)$ как было рассмотрено выше.
%
%Далее длительность $d$, полученная на выходе блока $\gamma$, подается на вход блока генератора случайной величины $(Q^v)^d$. В отличие от случайных величин $q^s_k$ и $q^d_k$ случайная величина $q^v$ принимает значения в множестве векторов длины $d$ ($(Q^v)^d$). Таким образом на выходе блока генератора случайной величины $(Q^v)^d$ получается вектор длины $d$, элементы которого генерируются в соответствии с одним и тем же распределением
%
%  \begin{center}
%  \begin{tabular}{l|c|c|r}
%    $q^v_1$ &$ q^v_2$ & ... & $q^v_{l_d}$ \\
%    \hline
%    $p^v_1$ & $p^v_2$ & ... & $p^v_{l_d}$ \\
%  \end{tabular}
%    \end{center}
%Полученная реализация случайного вектора подается на вход блока $\delta$. Блок реализует функцию выхода следующим образом:
%\begin{equation}
%\label{eq_delta}
%\delta:(Q^v)^d\times S \longrightarrow V^d, \;\;\; \delta(\{q^v_i\}_{i=1}^L,S)=\{\delta^\prime(q^v_i,S)\}_{i=1}^L,
%\end{equation}
%
%где $\delta^\prime$ задается по матрице $M^v(q^v_k)$ как было рассмотрено выше.
%
%\textbf{Теорема} (о полиномиальном представлении). Последовательность выходных значений процесса, описанного скрытой марковской моделью с явно заданной плотностью длительности состояний, можно представить последовательностью значений функции $\psi = f_3\cdot f_2 \cdot f_1$, т.е. суперпозиции трех полиномов вида (\ref{eq_pol}) над полем $F_{2^n}$, где $n$ --- наименьшее целое, удовлетворяющее условию $2^n\geq max(l_s,l_v,l_d)$.
%
%\textbf{Доказательство} проведем по аналогии с доказательством теоремы 2 из \cite{ZahNurSokShal}. Как уже было сделано ранее матрице $A$ системы (\ref{EDHMM}) поставим в соответствие отображение $\lambda(q^s, s): Q^s\times S \longrightarrow S$, где $|Q^s|=l_s$. Матрице $F$ системы (\ref{EDHMM}) ставится в соответствие отображение $\gamma(q^d, s): Q^v\times S \longrightarrow S$, где $|Q^d|=l_d$.
%
%Аналогично матрице $B$ системы (\ref{EDHMM}) ставится в соответствие отображение $\delta^\prime(q^v, s): Q^v\times S \longrightarrow S$, где $|Q^v|=l_v$. Определим отображение $\delta:(Q^v)^d\times S \longrightarrow V^d$ вида (\ref{eq_delta}).
%
%\emph{... тут надо подумать... Можно закодировать все последовательности и по такой табличке построить полином, но это не очень хорошо, т к значительно увеличивается мощность поля Галуа}
%
%
%Представим отображения $\lambda(q^s, s)$, $\gamma(q^d, s)$,$\delta(q^v, s)$, соответственно, полиномами $f_1(x_1,q)$, $f_2(x_2,q)$, $f_3(x_3,q)$, где, например, $x_1$ соответствует $q^s$ в $\lambda(q^s, s)$. Наименьшую степень поля $F_{2^n}$ определим из условия $2^n\geq max(l_s,l_v,l_d)$.
%
%\emph{...непонятно про то, как в эту полиномиальную запись вписывается моделирование выходных символов внутри длительности.}

\begin{example} Проиллюстрируем предложенный подход к построению полиномиального представления скрытой полумарковской модели типа Фергюсона. Для простоты алфавит состояний, алфавит длительностей и выходной алфавит принимаются бинарными. Рассмотрим скрытую полумарковскую модель фергюсоновского типа $\lambda$ вида (5), где
$S = \{S_1,S_2\}$, $V=F_2=\{0,1\}$, $D=\{1,2\}$,
\[A=\left(
      \begin{array}{cc}
        0.9 & 0.1 \\
        0.2 & 0.8 \\
      \end{array}
    \right);
   B=\left(
      \begin{array}{cc}
        0.1 & 0.9 \\
        0.3 & 0.7 \\
      \end{array}
    \right);
    F=\left(
      \begin{array}{cc}
        0.4 & 0.6 \\
        0.5 & 0.5 \\
      \end{array}
    \right);
    \pi=\left(\begin{array}{c}
      0.3 \\
      0.7
    \end{array}\right).
\]

Представим стохастические матрицы $A$,$B$ и $F$ в виде выпуклых линейных комбинаций простых матриц (см. (1), (6), (7), (8)) по алгоритму из [14] с. 26:
\[A=0.8\cdot \left(\begin{array}{cc}
               1 & 0 \\
               0 & 1
             \end{array}\right)+0.1\cdot \left(\begin{array}{cc}
               0 & 1 \\
               1 & 0
             \end{array}\right)+ 0.1\cdot \left(\begin{array}{cc}
               1 & 0 \\
               1 & 0
             \end{array}\right),\]
\[B=0.7\cdot \left(\begin{array}{cc}
               0 & 1 \\
               0 & 1
             \end{array}\right)+0.2\cdot \left(\begin{array}{cc}
               0 & 1 \\
               1 & 0
             \end{array}\right)+ 0.1\cdot \left(\begin{array}{cc}
               1 & 0 \\
               1 & 0
             \end{array}\right),\]
\[F=0.5\cdot \left(\begin{array}{cc}
               0 & 1 \\
               1 & 0
             \end{array}\right)+0.4\cdot \left(\begin{array}{cc}
               1 & 0 \\
               1 & 0
             \end{array}\right)+ 0.1\cdot \left(\begin{array}{cc}
               0 & 1 \\
               0 & 1
             \end{array}\right).\]
В нашем случае $l_A=l_B=l_F=3$. По разложениям матриц $A$,$B$,$F$ запишем соответствующие распределения для дискретных случайных величин $u^A$, $u^B$, $u^F$:

\[\begin{tabular}{c|c|c}
  $u_1^A$ & $u_2^A$ & $u_3^A$ \\
    \hline
  $0.8$ & $0.1$ & $0.1$ \\
\end{tabular}\;\;\;
\begin{tabular}{c|c|c}
  $u_1^B$ & $u_2^B$ & $u_3^B$ \\
    \hline
  $0.7$ & $0.2$ & $0.1$ \\
\end{tabular} \;\;\;
\begin{tabular}{c|c|c}
  $u_1^F$ & $u_2^F$ & $u_3^F$ \\
    \hline
  $0.5$ & $0.4$ & $0.1$ \\
\end{tabular}
\]

и определим отображения $\lambda^A$, $\lambda^B$ и $\lambda^F$ в табличном виде:
\[
\begin{tabular}{c|c|c}
  $\lambda^A$ & $S_1$ & $S_2$ \\
    \hline
  $u_1^A$ & $S_1$ & $S_2$ \\
    \hline
  $u_2^A$ & $S_2$ & $S_1$ \\
    \hline
  $u_3^A$ & $S_1$ & $S_1$ \\
\end{tabular} ;\;\;\;
\begin{tabular}{c|c|c}
  $\lambda^B$ & $S_1$ & $S_2$ \\
    \hline
  $u_1^B$ & $1$ & $1$ \\
    \hline
  $u_2^B$ & $1$ & $0$ \\
    \hline
  $u_3^B$ & $0$ & $0$ \\
\end{tabular};\;\;\;
\begin{tabular}{c|c|c}
  $\lambda^F$ & $S_1$ & $S_2$ \\
    \hline
  $u_1^F$ & $2$ & $1$ \\
    \hline
  $u_2^F$ & $1$ & $2$ \\
    \hline
  $u_3^F$ & $2$& $2$ \\
\end{tabular}\]

Теперь необходимо закодировать элементы множеств $U^A$, $U^B$, $U^F$, $S$, $V$, $D$ элементами поля Галуа. Минимальное натуральное $n$, для которого выполняется
$$2^n\geq max\{l_A,l_B,l_F,N,M,L\},$$
равно 4. Зафиксируем неприводимый многочлен $m(x)=x^2+x+1$ над полем Галуа $F_{2^2}$. Тогда $F_{2^2}=\{0,1,\xi,\xi^2\}$, где $\xi$ – примитивный элемент. Закодируем элементы множеств $U^A$, $U^B$, $U^F$, $S$, $V$, $D$ элементами поля $F_{2^2}$:

$$S=\{S_1,S_2\}\rightarrow\{0,1\},$$
$$F_2=\{0,1\}\rightarrow\{0,1\},$$
$$ D=\{1,2\}\rightarrow\{0,1\},$$
$$U^A=\{u_1^A,u_2^A,u_3^A \}\rightarrow\{0,1,\xi\},$$
$$U^B=\{u_1^B,u_2^B,u_3^B \}\rightarrow{0,1,\xi},$$
$$U^F=\{u_1^F,u_2^F,u_3^F \}\rightarrow{0,1,\xi}.$$

По $\lambda^A$, $\lambda^B$ и $\lambda^F$  запишем отображения $\hat{\lambda}^A$,$\hat{\lambda}^B$ и $\hat{\lambda}^F$, используя кодировку полем Галуа $F_{2^2}$ и доопределяя их нулями на недостающих элементах.
\[\begin{tabular}{c|c|c|c|c}
  $\hat{\lambda}^A$ & $0$ & $1$ & $\xi$ & $\xi^2$\\
    \hline
  $0$ & $0$ & $1$ & $0$ & $0$ \\
    \hline
  $1$ & $1$ & $0$ & $0$ & $0$ \\
    \hline
  $\xi$ & $0$ & $0$ & $0$ & $0$ \\
    \hline
  $\xi^2$ & $0$ & $0$ & $0$ & $0$ \\
\end{tabular};\;\;\;
\begin{tabular}{c|c|c|c|c}
  $\hat{\lambda}^B$ & $0$ & $1$ & $\xi$ & $\xi^2$\\
    \hline
  $0$ & $1$ & $1$ & $0$ & $0 $\\
    \hline
  $1$ & $1$ & $0$ & $0$ & $0$ \\
    \hline
  $\xi$ & $0$ & $0$ & $0$ & $0$ \\
    \hline
  $\xi^2$ & $0$ & $0$ & $0$ & $0$ \\
\end{tabular};\;\;\;
\begin{tabular}{c|c|c|c|c}
  $\hat{\lambda}^F$ & $0$ & $1$ & $\xi$ & $\xi^2$\\
    \hline
  $0$ & $1$ & $0$ & $0$ & $0$ \\
    \hline
  $1$ & $0$ & $1$ & $0$ & $0$ \\
    \hline
  $\xi$ & $1$ & $1$ & $0$ & $0$ \\
    \hline
  $\xi^2$ & $0$ & $0$ & $0$ & $0$ \\
\end{tabular}
\]
Для каждого из отображений $\hat{\lambda}^A$,$\hat{\lambda}^B$ и $\hat{\lambda}^F$, действующих из $F_{2^2}\times F_{2^2}$ в $F_{2^2}$, построим полином вида (4). Так, полином $f_A (x_A,q_A)$, соответствующий $\hat{\lambda}^A$, имеет вид:
$$f_A (x_A,q_A )=\sum\limits_{i,j=0}^3 h_{ij}^A x_A^j q_A^i,$$
где матрица коэффициентов $H^A=\{h_ij^A \}_{i,j=0}^3$ определяется формулой
$$H^A=C^{-1} Z^A {C^{-1} }^T,$$
матрица $C^{-1}$ в нашем случае имеет вид
$$C^{-1}=\left(
  \begin{array}{cccc}
    1 & 0 & 0 & 0 \\
    0 & 1 & \xi^2 & \xi \\
    1 & 1 & \xi & \xi^2 \\
    1 & 1 & 1 & 1 \\
  \end{array}
\right),$$

а матрица $Z^A$, определяемая значениями $\hat{\lambda}^A$ на элементах $F_{2^2}$, равна
$$Z^A=\left(
  \begin{array}{cccc}
    0 & 1 & 0 & 0 \\
    1 & 0 & 0 & 0 \\
    0 & 0 & 0 & 0 \\
    0 & 0 & 0 & 0 \\
  \end{array}
\right).$$
Тогда
$$H^A=\left(
  \begin{array}{cccc}
    0 & 1 & 1 & 1 \\
    1 & 0 & 0 & 1 \\
    1 & 0 & 0 & 1 \\
    1 & 1 & 1 & 0 \\
  \end{array}
\right).$$

Таким образом:
$$f_A (x_A,q_A )=q+q^2+q^3+x+xq^3+x^2+x^2 q^3+x^3+x^3 q+x^3 q^2.$$
Аналогично по отображениям $\hat{\lambda}^B$ и $\hat{\lambda}^F$ построим многочлены $f_B (x_B,q_B )$ и $f_F (x_F,q_F )$:
$$f_B (x_B,q_B )=1+q+q^2+x+xq^3+x^2+x^2 q^3+x^3 q+x^3 q^2+x^3 q^3,$$
\begin{eqnarray}f_F (x_F,q_F )=& 1+q^3+\xi^2 x+(1+\xi^2 )xq+(1+\xi^2 )xq^2+xq^3+ \nonumber\\ &\xi x^2+(1+\xi) x^2 q  +(1+\xi) x^2 q^2+x^2 q^3.\nonumber\end{eqnarray}
Определив полиномы $f_A (x_A,q_A )$, $f_B (x_B,q_B )$ и $f_F (x_F,q_F )$, мы фактически построили полиномиальное представление рассматриваемой фергюсоновской скрытой полумарковской модели.
\end{example}

\subsection{О связи скрытой полумарковской модели Фергюсновского типа со скрытой полумарковской QP-моделью} \label{sect2_3}
Рассмотрим скрытую полумарковскую модель Фергюсновского типа $\lambda_{Ferg}=\{S_{Ferg}, D_{Ferg}, A_{Ferg},\Pi_{Ferg},F_{Ferg},{\mathbb{F}}_q,B_{Ferg}\}$ и скрытую полумарковской QP-модель $\lambda_{QP}=\{\mathcal{S}_{QP};\mathcal{D}_{QP}; A_{QP}; \Pi_{QP}; F_{QP}; \rho; \mu ; M ;{\mathbb{F}}_q;B_{QP} \}$.
Пусть $S_{Ferg}=\mathcal{S}_{QP}$, $\mathcal{D}_{QP}=D_{Ferg}$, $A_{Ferg}=A_{QP}$, $\Pi_{Ferg}=\Pi_{QP}$, $F_{Ferg}=F_{QP}$.


1) Что куда вкладывается или есть общая часть?

(!!!доработать полиномиальное представление для СММQP-модели!!!) м.б. не надо.


\subsection{Имитационная (компьютерная) модель. Численные примеры.} \label{sect2_4}


отчет о программе

примеры реализации

преимущество полиномиального представления


\clearpage 