\section{Имитационное моделирование цифровых помехоустойчивых каналов связи} \label{chapt1_Problem}

В настоящем разделе приводятся необходимые сведения о цифровых помехоустойчивых каналах связи и имитационном моделировании таких каналов, обсуждаются существующие методы математического моделирования помеховой обстановки, в частности моделирование потоков ошибок на основе цепей Маркова, устанавливается необходимость построения универсальной модели источника ошибок. Кроме того, рассматривается проблема подбора помехоусточивого кодека для реального канала связи и ее решение на основе информационной системы оценки применимости схем помехоусточивого кодирования (ИС ОПСАПК). Ставится задача адекватного представления помеховой обстановки в реальном канале данных математической моделью источника ошибок.

\subsection{Цифровые системы передачи данных.}\label{chapt1_digital_systems}
Приведем необходимые сведения о цифровых системах передачи данных \cite{Prokis}, \cite{DeMoMet1}, \cite{DeMoMet2}. Основную задачу теории и техники связи составляет передача сообщений из одного пункта в другой.
Совокупность передатчиков, приемников и каналов, обеспечивающих обмен сообщениями между пунктами связи, называют \textit{системой передачи информации} или \textit{системой связи} (см. рис. 1).

\begin{center}
\includegraphics[height=80mm]{/part1/transmission_schema.png}

Рис.1. Основные элементы цифровой системы передачи информации.
\end{center}

Поясним основные элементы цифровой системы связи и их взаимодействие. Выход источника $S(t)$ может представлять собой как аналоговый, так и цифровой сигнал. Под цифровым сигналом понимается дискретный по времени и имеющий конечное число выходных значений сигнал. В системе цифровой связи сообщения, выданные источником, преобразуются в последовательность $q$-ичных (чаще всего двоичных) символов $b(t)$. Процесс эффективного преобразования выхода источника –- как аналогового, так и цифрового --- в последовательность $q$-ичных называют кодированием источника.

Последовательность $q$-ичных символов от кодера источника поступает на кодер канала. Кодер канала вносит управляемым способом некоторую избыточность в информационную последовательность $b(t)$, которая может использоваться в приёмнике для преодоления воздействия шума, возникающего при передаче сигнала по каналу.

Полученная на выходе кодера канала $q$-ичная последовательность $b_R(t)$ поступает на вход цифрового модулятора, который служит интерфейсом к каналу связи. Задачей цифрового модулятора является представление информационной последовательности в виде, подходящем для передачи по физическому каналу, т.е. отображение информационной последовательности $b_R(t)$ в соответствующую последовательность сигналов $u(t)$. Часто символы $q$-ичного алфавита представляются в виде слов над двоичным алфавитом, которым модулятор ставит в соответствие сигналы, которые могут отличаться по амплитуде, фазе и частоте или зависеть от двух и более сигнальных параметров. Модуляторы разделяют на модуляторы с памятью, когда передаваемый сигнал зависит от сигналов, переданных на предыдущих временных интервалах, и без памяти, когда передаваемый сигнал не зависит от передаваемых ранее. Кроме того, существует разделение модуляторов на линейные и нелинейные. В числе линейных методов модуляции выделяют амплитудно-импульсную модуляцию, фазовую модуляцию, квадратурную амплитудную модуляцию. Среди примеров нелинейной модуляции можно отметить частотную модуляцию с непрерывной фазой, модуляцию с непрерывной фазой, модуляцию с минимальным сдвигом. Подробнее о модуляции написано в \cite{Prokis}, раздел 4.3.

\textit{Каналом} связи называют совокупность средств передачи информации, включающую в себя физическую среду. Для любой физической среды, используемой для передачи информации, существенно, что передаваемый сигнал подвержен случайным искажениям.

На приёмной стороне системы цифровой связи цифровой демодулятор преобразует искажённый каналом передаваемый сигнал $u^*(t)$ в последовательность символов $b^*_R(t)$, которые представляют оценки переданных данных. Эта последовательность поступает на канальный декодер, задача которого состоит в восстановлении первоначальной информационной последовательности на основе знания канального кода и избыточности, содержащейся в принятых данных. При невозможности принять достаточно надежное решение относительно какой-либо позиции декодер может выдать сигнал стирания, означающий отказ от решения.

Мерой качества работы демодулятора и декодера является частота возникновения ошибок декодируемой последовательности. В частности, средняя вероятность ошибки на бит для выходных символов декодера представляется удобной характеристикой качества демодулятора-декодера.

На заключительной стадии декодер источника принимает выходную последовательность $b^*(t)$  от декодера канала и, используя знание о применённом при передаче методе кодирования источника, пытается восстановить исходную форму сигнала источника $S^*(t)$. Ошибки декодирования и возможные искажения в кодере и декодере источника приводят к тому, что сигнал на выходе декодера источника является аппроксимацией исходного сигнала источника.

Говоря о конкретных каналах связи, можно выделить следующие несколько типов: проводные каналы, волоконно-оптические каналы, беспроводные (радио) каналы, подводные аккустические каналы. Системы хранения и системы поиска информации (например, магнитная лента, видеолента, компакт-диск) также могут рассматриваться как каналы связи. Перечисленные типы каналов имеют в основе различные физические каналы, однако, все они подвержены одной общей проблеме -- аддитивному шуму.

Далее рассмотрим некоторые свойства канала связи. Цифровой канал называется $q$-ичным, если его алфавит имеет мощность $q$. В случае, когда мощность алфавита --- степень простого числа, в качестве алфавита, как правило, рассматривается поле Галуа $F_q$.

Отметим, что существует несколько способов представления элементов полей Галуа $F_q$. Наибольшее распространение получили следующие способы: в виде степеней $\alpha^i$ примитивного элемента $\alpha$, логарифмов $\log(\alpha^i)$ по основанию $\alpha$, десятичных номеров-чисел $N$ (модифицированных логарифмов), $q$-ичных векторов и полиномов и др. \cite{Mutter}. Для удобства использования и, в частности, удобства программной реализации далее мы будем подразумевать представление элементов поля Галуа в виде модифицированных логарифмов. Для примитивного элемента $\alpha$ поля Галуа $F_q$ модифицированный логарифм $N$ определяется, как
$$N=\log_{\alpha}(\alpha^N-1)+1.$$

$q$-ичный канал называется \textit{симметричным}, если в канале вероятность замещения символа $a$ каким-то другим символом $b$, отличным от $a$, от значения $b$ не зависит.

Канал, в котором каждый символ выходной последовательности зависит не только от соответствующего символа на входе, но и от предыдущих символов, называется каналом с памятью. Большинство реальных каналов является каналами с памятью. В случае канала с памятью можно ввести понятие состояния канала, тогда каждый символ выходной последовательности зависит как от соответствующего символа на входе, так и от состояния канала.

Каналы связи называют идеально \textit{синхронизированными}, если в них есть механизмы, позволяющие препятствовать влиянию ошибок типа выпадения и вставки символов. Канал связи называется \textit{стационарным}, если его статистические характеристики не зависят от времени.

Реальные цифровые каналы связи в общем случае неидеально синхронизированы, нестационарны, несимметричны и имеют память, однако учесть при моделировании канала одновременно влияние всех этих факторов достаточно сложно. Поэтому в дальнейшем будем, как правило, рассматривать идеально синхронизированные, симметричные, нестационарные каналы с памятью.

\subsection{Помехи и ошибки в каналах связи}
Под \textit{помехой} в канале связи понимают любое нежелательное воздействие на сигнал, которое ухудшает достоверность воспроизведения передаваемых сообщений. Помехи разнообразны как по своему происхождению, так и по физическим свойствам. Различают случайные и специально организованные помехи. В зависимости от источника возникновения случайные помехи подразделяют, например, на промышленные, атмосферные, космические, помехи от посторонних радиостанций и каналов, внутренние шумы аппаратуры и др.

Источники помех бывают внутренние и внешние \cite{Davidov}. Внутренние шумы связаны с физической природой источников сигналов (например, тепловые шумы электрических цепях) или возникают в измерительных устройствах и системах передачи и обработки сигналов под действием таких дестабилизирующих факторов как температура, повышенная влажность, влияние механических вибраций на гальванические соединения и т.п. Внешние источники шумов разделяют на источники искусственного происхождения (индустриальные помехи - двигатели, переключатели, генераторы сигналов различной формы) и естественного происхождения (молнии, флуктуации магнитных полей, всплески солнечной энергии).

Помехи подразделяются на флуктуационные, импульсные и периодические. Флуктуационные помехи представляют хаотический и беспорядочный во времени процесс в виде нерегулярных случайных всплесков различной амплитуды. Импульсные помехи проявляются как в виде отдельных импульсов, так и в виде последовательности импульсов, форма и параметры которых имеют случайный характер. Периодические помехи могут вызываться периодическими низкочастотными или высокочастотными полями линий электропередач, силовых электроустановок и др.

По характеру воздействия на сигнал помехи разделяют на аддитивные и мультипликативные. Аддитивные (налагающиеся) помехи суммируются с сигналом, не зависят от его значений и формы и не изменяют информативной составляющей самого сигнала. Мультипликативные или деформирующие помехи могут изменять форму информационной части сигнала, иметь зависимость от его значений и от определенных особенностей в сигнале и т.п. При известном характере мультипликативных помех возможна коррекция сигнала на их влияние. Далее будем мы иметь дело с аддитивными помехами.

В результате воздействия помех данные, передаваемые по каналу связи, могут искажаться. Тогда принятое сообщение будет отличаться от переданного, т.е. сообщение будет принято с ошибкой. \textit{Ошибкой} в канале называют событие, состоящее в том, что воспроизводимая последовательность не совпадает с исходной. Экспериментальные исследования каналов связи показывают, что ошибки при передаче данных по каналу обычно группируются в пачки (пакеты) различной длительности \cite{Berezuk}. Пачкой (пакетом) ошибок называется участок последовательности, начинающийся и кончающийся ошибочно принятыми элементами. Внутри пачки могут быть и правильно принятые элементы.

\subsection{Имитационные модели каналов.}
Для проектирования реальных каналов удобно предварительно рассматривать имитационные модели этих каналов. Под \textit{имитационным моделированием} принято понимать воспроизведение процесса функционирования исследуемой системы с соблюдением логической и временной последовательности протекания процессов.

На рис.2 показана классическая структура абстрактной имитационной модели \cite{DeMoMa}, \cite{DeMoMet2}. Рассмотрим подробнее составляющие ее блоки. Блок имитации внешних воздействий (БИВВ) формирует реализации случайных или детерминированных процессов, имитирующих воздействия внешней среды на объект. Блок обработки результатов (БОР) предназначен для получения информативных характеристик исследуемого объекта, а необходимая для этого информация поступает из блока математической модели объекта (БММО). Блок управления имитационной модели (БУИМ) реализует способ исследования имитационной модели, основное назначение этого блока -- автоматизация процесса проведения имитационных экспериментов.

\begin{center}
\includegraphics[height=40mm]{/part1/imitation_simple.png}

Рис.2. Структурная схема имитационной модели.
\end{center}

Рассмотрим имитационную модель, для которой моделируемым объектом является цифровой помехоустойчивый канал (см. рис. 3).

\begin{center}
\includegraphics[height=100mm]{/part1/isopsapk.jpg}

Рис.3. Укрупненная схема имитационной модели цифрового помехоустойчивого канала связи.
\end{center}

Блоком математической модели объекта (БМMО) в такой модели является блок математической модели цифрового помехоустойчивого канала (ЦПК).На укрупненной структурной схеме БМMО включает пять блоков: ”источник сообщений”, ”кодер канала”, ”линия связи”, ”декодер канала” и ”приемник сообщений”. ”Источник сообщений” посылает блоку ”кодер канала” поток дискретных данных. Закодированные данные с выхода блока ”кодер канала” поступают в блок ”линия связи”. ”Декодер канала” из блока ”линия связи” получает искаженный в результате воздействия блока БИВВ поток данных. С выхода блока ”декодер канала” данные поступают на вход блока ”приемник сообщений”.  Задача блоков ”Кодер канала” и ”Декодер канала” заключается в помехоустойчивом кодировании и декодировании данных соответственно. Кодер и декодер могут состоять из одного алгоритма, а могут быть построены в виде каскада из кодеров, перемежителей, декодеров и деперемежителей.

Блок имитации внешних воздействий (БИВВ) отвечает за моделирование шума и его задача заключается в моделировании источника ошибок. Результатом работы этого блока является поток ошибок, который воздействует на передаваемые данные. В качестве модели источника ошибок может быть выбрана любая известная модель, однако, целесообразным  представляется использование моделей ошибок, настройками параметров которых можно моделировать различные случаи помеховой обстановки \cite{DeMoMa}.

 Блок управления имитационной модели ЦПК позволяет задавать и валидирует параметры проводимого эксперимента или серии экспериментов; отвечает за синхронизацию работы источника сообщений и источника потока ошибок, чтобы на каждый символ сообщения приходился один символ потока ошибок; определяет вид статистической обработки результатов экспериментов.

 Блок обработки результатов (БОР) в ИМ ЦПК осуществляет вычисление ряда характеристик как ошибок, внесенных каналом, так и ошибок, оставшихся в сообщении после декодирования. Другой задачей БОР является осуществление связи имитационной модели ЦПК с базой данных, в которой сохраняется информация о проведенных эксперименты.

\subsection{Методы моделирования помех.}
Разработкой моделей источников ошибок занимались многие ученые: Э.Н. Гильберт, Е.О. Эллиот, Б.М. Игельник, В.И. Петрович, Б.Д. Фричман, В.М. Охорзин, В.О. Колпаков, В.Я. Турин, О.В. Попов, Ю.С. Чье и другие. Обычно математическая модель описывает некоторый очень узкий класс каналов, поэтому для исследования корректирующей способности кодека по отношению к различным типам ошибок при проведении имитационных экспериментов необходимо использовать несколько моделей источников ошибок. Это затрудняет проведение имитационных экспериментов, так как в их процессе приходится тестировать корректирующую способность кодеков для разных моделей и различных значений параметров моделей. Представляется более удобным построить общую модель источника ошибок канала, которая учитывала бы $q$-ичные алфавиты и позволила бы моделировать различные случаи помеховой обстановки.

Существует несколько подходов к математическому моделированию источников ошибок. В \cite{Finaev}, \cite{Bloch}, \cite{DeMoMet1} приведены три общие схемы их описания: схема, основанная на цепях Маркова; схема, основанная на процессах восстановления; схема на основе процессов накопления.
Несколько иной подход к моделированию источников ошибок, основанный на теории квазипериодических последовательностей случайных величин был предложен в \cite{DeMoRGUPS}, \cite{DeMoSevKav}. К достоинствам этой модели можно отнести возможность моделировать различные типы помеховой обстановки путем изменения параметров модели. В \cite{BelChak} представлен еще один подход к моделированию источников ошибок, а именно, разработана формально-грамматическая модель шума, позволяющая генерировать квазипериодический процесс на основе модификации атрибутной грамматики Д.~Кнута.

В дальнейшем интерес для нас будут представлять модели, построенные на основе марковских цепей, поэтому ниже рассмотрим примеры некоторых из классических математических моделей источников ошибок этого типа.

Приведем описание источника ошибок на основе цепей Маркова из \cite{Turin71}. Вслед за Туриным будем рассматривать случай двоичного симметричного идеально синхнронизированного канала, который может находиться в одном из $N$ несовместных физических состояний $S=\{0,1,..., N-1\}$.

Пусть имеется $N$-ичный процесс состояний $\{S_i\}$, где $s_i\in S$, представляющий собой простую цепь Маркова.  Значение ошибки на шаге $i$, то есть в состоянии $s_i$, будем обозначать $e_i$. Вероятность того или иного из двух возможных значений ошибки $e_i$ полностью определяется значением состояния $s_i$ на этой позиции:
$$P(e_i|e_{i-1}...e_{i-\nu}s_is_{i-1}...s_{i-\nu})=P(e_i|s_i)=\varepsilon_{s_i}\;\;\; (\nu\rightarrow \infty).$$

Таким образом, статистика последовательности ошибок $\{E_i\}$ полностью определяется матрицей переходных вероятностей $P$ порядка $N$
\begin{equation}
\label{ch1_matr}
P=\{p_{ij}\}_{}=\left(
                      \begin{array}{cccc}
                        p_{00} & p_{01} & \ldots & p_{0,N-1} \\
                        p_{10} & p_{11} & \ldots & p_{1,N-1} \\
                        \vdots & \vdots & \ldots & \vdots \\
                        p_{N-1,0} & p_{N-1, 1} & \ldots & p_{N-1, 1} \\
                      \end{array}
                    \right)
\end{equation}
и значениями вероятности ошибки в каждом состоянии $\epsilon_0,...,\epsilon_{N-1}$. В частности, вероятность ошибки в канале записывается выражением
$$p_e=\sum\limits_{i=0}^{N-1} P_i\epsilon_i,$$
где $P_i$ -- финальные вероятности состояний, которые определяются по матрице (\ref{ch1_matr}) из системы уравнений:
$$\sum\limits_{i=0}^{N=1}P_{i}=1;$$
$$\sum\limits_{j=0}^{N=1}P_{i}p_{ij}=P_{j};$$
где $i=0,..., N-1$, ($P_{i}=P_{j}$, если $i=j$).

Обычно состояния канала разделяют на две группы, в одной из которых вероятности ошибок значительно ниже, чем во второй. Состояния первой группы условимся называть ”хорошими”, а состояния второй группы -- ”плохими”. В общем случае в различных состояниях вероятности ошибок $\epsilon_{i}$ различны. В ряде случаев можно полагать, что ошибки возможны только в плохих состояниях. Введение различных состояний с одинаковыми вероятностями ошибки позволяет отобразить группирование пакетов ошибок в более сложные структуры.

Теперь рассмотрим некоторые частные случаи моделей источников ошибок, описанных на основе цепей Маркова.

\emph{Модель Гильберта.} Рассмотрим канал, который может находиться в двух состояниях –- ”хорошем” и ”плохом”. В ”хорошем”
состоянии ошибки быть не может, а в ”плохом” ошибки возникают с
некоторой вероятностью $\epsilon$ . Последовательность состояний образует простую цепь
Маркова. Таким образом модель Гилберта соответствует описанной выше схеме с двумя состояниями.
Статистика последовательности ошибок $\{e_i\}$  определяется матрицей
переходных вероятностей
$$P=
        \left(\begin{array}{cccc}
           p_{00} & p_{01} \\
           p_{10} & p_{11}\\
        \end{array}\right)$$
и величиной $\epsilon$.

Наложение условия $p_{01}<<p_{00}$,  $p_{10}<<p_{11}$ позволит отобразить группирование ошибок в пакеты. Граф переходных вероятностей для модели Гильберта представлен на рис.5.

\begin{center}
\includegraphics[height=35mm]{/part1/gilb.pdf}

Рис.4. Граф переходных вероятностей модели Гильберта.
\end{center}

Вероятность ошибки в канале определяется по формуле:
$$p_{\mathrm{er}}=\frac{\epsilon p_{01}}{p_{01}+p_{10}}.$$
$p_{\mathrm{er}}$ обычно меньше условной вероятности ошибки в пакете $\epsilon$, поэтому $p_{01}<p{10}$.
Вероятность возникновения пакета ошибок с данного символа
$$p_{n}=\frac{p_{01}p_{10}}{p_{01}+p_{10}}.$$

Более поздней модификацией модели Гильберта является модель Гильберта-Эллиота, допускающая наличие ошибок  в
"хорошем" \; состоянии  канала. В этом случае помимо матрицы переходных вероятностей задаются условные вероятности  $\epsilon_0$ и  $\epsilon_1$. Вероятность ошибки определится по формуле
$$p_{er}=\frac{\epsilon_0 p_{10}+\epsilon_1 p_{01}}{p_{01}+p_{10}}.$$

\emph{Модели Фричмана и Фричмана-Свободы.} Модель Фричмана не предусматривает ограничения на число ”хороших” и ”плохих” состояний. Полагается, что в ”хороших” состояниях невозможны ошибки, а в ”плохих” невозможен правильный прием. Последовательность состояний образует простую цепь Маркова.
Частный случай модели Фричмана -- модель Фричмана-Свободы предусматривает только одно ”плохое” состояние, и переходы из ”хороших” состояний в другие ”хорошие” невозможны. Матрица переходных вероятностей для модели Фричмана-Свободы с $N$ состояниями имеет вид:
$$P=
         \left(\begin{array}{ccccc}
           p_{11} & 0 & \ldots & 0 & p_{1, N} \\
           0 & p_{22} & \ldots & 0 & p_{2, N} \\
           \vdots & \vdots & \ddots & \vdots & \vdots \\
           0 & 0 & \ldots & p_{N-1, N-1} & p_{N-1, N}\\
           p_{N, 1} & p_{N, 2} & \ldots & p_{N, N-1}& p_{N, N}
        \end{array}\right).$$

Финальные вероятности ”хороших” состояний определяются выражениями:
$$P_1=P_{N}\frac{p_{N,1}}{p_{1,N}};P_2=P_{N}\frac{p_{N,2}}{p_{2,N}};\ldots; P_{N-1}=P_{N}\frac{p_{N,N-1}}{p_{N-1,N}}.$$

Финальная вероятность плохого состояния, равная вероятности ошибки, определяется выражением:
$$P_N=(1+\frac{p_{N,1}}{p_{1,N}}+\frac{p_{N,2}}{p_{2,N}}+\ldots+\frac{p_{N,N-1}}{p_{N-1,N}})^{-1}=P_{\mathrm{er}}.$$

Модели Фричмана и Фричмана-Свободы позволяют отразить группирование пакетов ошибок, распределение длин пакетов по этим моделям является геометрическим.

