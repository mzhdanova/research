\section{Скрытая полумарковская модель фергюсоновского типа.} \label{chapt2_Ferguson}
В настоящем разделе на основе скрытой полумарковской модели фергюсоновского типа строится математическая модель источника ошибок в $q$-ичном цифровом канале $N$ физических состояний и решается задача построения полиномиального представления этой модели.

Представлению конечных однородных цепей Маркова и некоторых типов автономных вероятностных автоматов полиномиальными функциями над полями Галуа посвящены работы \cite{Nurutdinov}, \cite{ZahNurSokShal}. В работе \cite{ZahNurSokShal} предлагается полиномиальное представление автомата, представляющего собой скрытую марковскую модель \cite{Rabiner}. Такого рода представление позволяет реализовывать генераторы последовательностей символов посредством программируемых логических
интегральных схем, что значительно увеличит эффективность реализации. Использование полей Галуа вида $F_{2^n}$ представляется удобным для этих целей в силу возможности построения параллельной реализации алгоритмов вычислений в них. В работе \cite{ZahAmin} определяются асимптотические  характеристики регулярных укрупняемых и укрупненных цепей Маркова и предлагается эффективный метод вычисления асимптотических характеристик некоторых функций укрупненных цепей Маркова, указывается на связь с результатами \cite{DeZhdaVGU_13}.

\subsection{Скрытая полумарковская модель источника ошибок фергюсоновского типа.}
Рассмотрим абстрактную скрытую полумарковскую модель фергюсоновского типа и построим на ее основе математическую модель источника ошибок в $q$-ичном цифровом канале $N$ физических состояний.

\begin{definition}Скрытой полумарковской моделью фергюсоновского типа будем называть систему:
\begin{equation}\label{chapt2_Ferguson_model:def} \Delta =\{S,A,\pi,V,B,D,F\},\end{equation}
где
1) $S=\{S_1,S_2,...,S_N\}$ -- алфавит состояний модели;

2) $A=\{a_{ij}\}_{i,j=1}^N$ -- матрица переходов;

3) $\pi=\{\pi_i \}_{i=1}^N$ –- вектор начального распределения вероятностей состояний;

4) $V=\{v_1,v_2,...,v_M\}$ –- алфавит наблюдаемых символов;

5) $B=\{b_{ij}\}_{i,j=1}^{N,M}$–- матрица условных вероятностей наблюдения символа $v_j$ в состоянии $S_i$;

6) $D$ –- алфавит возможных длительностей мощности $L$;

7) $F=\{f_{ij}\}_{i,d=1}^{N,L}$ –- матрица размера $N\times L$, элемент $f_{ij}$  которой представляет собой вероятность наблюдать длительность $d_j$ при условии, что $\Delta$ находится в состоянии $S_i$.
\end{definition}

Описываемая модель была впервые предложена Фергюсоном в \cite{Ferguson} и в литературных источниках известна как скрытая марковская модель с изменяющейся длительностью (Hidden Markov model with variable duration, \cite{Levinson}) и (в более поздних работах \cite{Rabiner}, \cite{YuKobayashi}) как скрытая марковская модель с явно заданной плотностью длительности состояний (Explicit duration Hidden Markov model). В дальнейшем будем для краткости называть ее в дальнейшем скрытой полумарковской моделью фергюсоновского типа.

На основе скрытой полумаркоской модели фергюсоновского типа построим математическую модель источника ошибок. Будем рассматривать симметричный стационарный идеально синхронизированный цифровой канал передачи данных $C$, по которому передается информация в виде символов $q$-ичного алфавита, отождествляемого с полем Галуа $F_q$. Канал $C$ может находиться в одном из $N$ различных физических состояний в течение некоторого промежутка времени, после чего переходит в следующее состояние. Предполагается, что для произвольного состояния распределение длительностей пребывания в нем фиксировано. В каждом из состояний могут возникать независимые аддитивные ошибки с собственным фиксированным распределением.

Источник ошибок в рассмотренном канале передачи данных $C$ может быть описан скрытой полумарковской моделью фергюсоновского типа. Для этого набору физических состояний канала поставим в соответствие алфавит $S=\{S_1,S_2,…,S_N \}$, вероятности переходов между состояниями зададим матрицей $A=\{a_{ij}\}_(i,j=1)^N$, начальное распределение вероятностей состояний определим вектором $\pi=\{\pi_i\}_{i=1}^N$. Пусть $D$ –- множество всех возможных длительностей состояний, а элемент $f_{ij}$ матрицы $F=\{f_{ij}\}_{i,j=1}^{N,L}$–- вероятность наблюдения длительности $d_j$ при условии, что канал передачи данных $C$ находится в состоянии $S_i$. В качестве выходного алфавита $V$ модели источника ошибок в канале $C$ выступает алфавит канала, а вероятности наблюдения различных значений ошибки в различных состояниях канала задаются в виде матрицы $B=\{b_{ij}\}_{i,j=1}^{N,q}$.

Иногда удобно рассматривать расширенное множество возможных длительностей состояний. Пусть $D_{\mathrm{max}}$ -- максимальный элемент множества $D$. Дополним множество $D$ так, чтобы получившееся множество имело вид $D=\{1, 2,.., D_{\mathrm{max}}\}$. Тогда матрицу $F$ можно представить как $=\{p_i(d)\}_{i,d=1}^{N,D_{\mathrm{max}}}$, где элемент $p_i(d)$ -- вероятность наблюдать длительность $d$ при условии, что $\Delta$ находится в состоянии $S_i$.

Определенная выше модель (см. (\ref{chapt2_Ferguson_model:def})) представляет собой общую скрытую полумарковскую модель из работы \cite{Yu}, которая полностью описана в разделе \ref{chapt1_GSHMM}, с наложенными на нее следующими дополнительными ограничениями:

1) текущее состояние не зависит от длительности предыдущего состояния;

2) текущая длительность определяется только текущим состоянием и не зависит от предыдущего состояния и его длительности;

3) наблюдения символов выходного алфавита внутри длительности полагаются условно независимыми с распределением вероятностей, зависящим только от текущего состояния, но не от его длительности.

Ограничения 1) -- 2) можно записать в виде:
\begin{equation}\label{eq:chapt2_ferguson:inclus1} a_{(i,d)(j,d^\prime)}= a_{ij}\cdot p_j(d^\prime), \;\;\; a_{ii}=0,\end{equation}
где $a_{ij}=P[S_{[t=j}|S_{t-1]=i}]$, а ограничение 3):
\begin{equation}\label{eq:chapt2_ferguson:inclus2}b_{j,d}(O_{t+1:t+d})=\prod\limits_{\tau=t+1}^{t+d}b_j(O_\tau).\end{equation}

Отметим также, что если алфавит возможных длительностей содержит только один элемент и, следовательно, матрица $F$ представляет собой вектор длины $N$, все элементы которого равны $1$, то скрытая полумарковская модель типа Фергюсона сводится к скрытой марковской модели.

Процесс генерирования последовательности наблюдений посредством модели типа Фергюсона выглядит следующим образом.

 \textbf{Этап 1.} В соответствии либо с вектором $\pi$ (в момент времени $t=1$ ), либо с матрицей $A$ выбирается текущее состояние.

 \textbf{Этап 2.} В выбранном состоянии $S_i$ с использованием $p_i(d)$ определяется длина временного промежутка, втечение которого система будет находиться в $i$-ом состоянии.

 \textbf{Этап 3.} В каждой точке этого отрезка посредством $b_i(k)$ генерируется наблюдение.

\subsection{Вспомогательные результаты о полиномиальном представлении одного класса стохастических матриц.}
В работах \cite{Nurutdinov},  \cite{ZahNurSokShal} были построены полиномиальные модели для некоторых типов вероятностных автоматов, в частности, автоматов, реализующих простую однородную цепь Маркова и скрытую марковскую модель. В основе построения полиномиальных моделей лежит сопоставление переходной и, в случае скрытой марковской модели, выходной матрице полинома от двух переменных. В этом разделе опишем принцип, позволяющий по абстрактной прямоугольной стохастической по строкам матрице построить полином двух переменных над полем Галуа $F_{2^n}$.

Пусть $X$, $Y$ -– конечные множества элементарных событий. Рассмотрим прямоугольную стохастическую по строкам матрицу $P$ размера $|X|\times|Y|$, составленную из условных вероятностей
$$P=\left(
      \begin{array}{ccc}
        P(y_1|x_1) & \ldots & P(y_{|Y|}|x_1) \\
        \vdots & \ddots & \vdots \\
        P(y_1 |x_{|X|}) & \ldots & P(y_{|Y|}|x_{|X|} ) \\
      \end{array}
    \right)
$$
где
$$\forall i\in [1,|X|]:x_i\in X, \forall j\in[1,|Y|]:y_j\in Y.$$
Каждая стохастическая по строкам матрица размера $n\times m$ может быть представлена как выпуклая линейная комбинация не более чем $n(m-1)+1$ простых матриц (см. \cite{ZahNurSokShal} и \cite{Pospelov}, с. 26). (Стохастические матрицы, в которых все элементы нули и единицы, называются простыми \cite{Pospelov}, с. 26). Поэтому:
\begin{equation}  \label{eq:chapt2_Ferguson:general_expansion}
P=\sum\limits{k=1}^l_P p_k^P M^P(u_k^P), \;\; l_P\leq |X|(|Y|-1)+1,
\end{equation}
где для любого $k\in[1,l_P]$
\begin{equation}
\label{eq:chapt2_Ferguson:general_simple_matrix}
M^P (u_k^P )={\mu_{ij}^P (u_k^P)}_{i,j=1}^{|X|,|Y|}
\end{equation} -– простая матрица размера $|X|\times|Y|$ и выполняется условие:
$$0\leq p_k^P\leq1 ,\;\;\; \sum\limits_{k=1}^{l_P}p_k^P =1.$$
По (\ref{eq:chapt2_Ferguson:general_expansion}) построим случайную величину $u^P$, принимающую значения на множестве $U^P$, где $|U^P|=l_P$, и распределенную по следующему закону:
$$\begin{tabular}{c|c|c|c}
    $u_1^P$ & $u_2^P$ & \ldots & $u_{l_P}^P$ \\
        \hline
    $p_1^P$& $p_2^P$ & \ldots & $p_{l_P}^P$ \\
  \end{tabular}
$$
Обозначим
\begin{equation}
\label{eq:chapt2_Ferguson:general_Phi}
\Phi^P (P)=u^P.
\end{equation}
Теперь, используя случайную величину $u^P$ и представление (\ref{eq:chapt2_Ferguson:general_expansion}), определим по простой матрице (\ref{eq:chapt2_Ferguson:general_simple_matrix}) отображение $\lambda^P:U^P\times X\rightarrow Y$, для которого $\lambda^P (u^P,x_i)=y_j$ при $\mu_{ij}^P (u^P)=1$.

Опишем принцип построения по отображению $\lambda^P$ многочлена двух переменных над полем Галуа \cite{Nurutdinov}. Зададим минимальное натуральное $n$, для которого
$$2^n\geq max\{l_P,|X|,|Y|\},$$
и установим взаимно-однозначные соответствия между элементами каждого из множеств $U^P$,$X$,$Y$ и элементами поля Галуа $F_{2^n}$. Обозначим отображение, определенное на $F_{2^n}\times F_{2^n}$ и соответствующее $\lambda^P$, через
$\hat{\lambda}^P:F_{2^n}\times F_{2^n}\rightarrow F_{2^n}$.
Соответствие понимается в том смысле, что на $\hat{x},\hat{y}\in F_{2^n}$, кодирующих $x\in X$,$y\in Y$, функция $\hat{\lambda}^P (\hat{x},\hat{y})$ принимает значение, кодирующее $\lambda^P (x,y)$. Известно, что для произвольного отображения $\varphi:F_{2^n}\times F_{2^n}\rightarrow F_{2^n}$ существует единственный полином вида
\begin{equation}
\label{eq:chapt2_Ferguson:general_polinom}
f(x,q)=\sum\limits_{i,j=0}^r h_{ij} x^j q^i,\;\;\; r=2^n-1,
\end{equation}
где $x,q,h_{ij}\in F_{2^n}$, являющийся представлением отображения $\varphi$ в том смысле, что $f(c_1,c_2)=\varphi(c_1,c_2)$ для всех $c_1,c_2\in F_{2^n}$; матрица коэффициентов многочлена (\ref{eq:chapt2_Ferguson:general_polinom}) определяется из следующего соотношения:
$$H=C^{-1} Z(C^{-1} )^T,$$
где $Z={z_{ij}}_(i,j=0)^(r-1)$   –- матрица значений отображения $\varphi$ на элементах поля $F_{2^n}$ и
\[C^{-1}=\left(
  \begin{array}{ccccccc}
    1 & 0 & 0 & \ldots & 0 & \ldots & 0 \\
    0 & 1 & \xi^{r-1} & \ldots & \xi^{(r-1)i mod(r)} & \ldots & \xi \\
    \ldots & \ldots & \ldots & \ldots & \ldots & \ldots & \ldots \\
    0 & 1 & \xi^2 & \ldots & \xi^{2i mod(r)} & \ldots & \xi^{r-2} \\
    0 & 1 & \xi & \ldots & \xi^i & \ldots & \xi^{r-1} \\
    1 & 1 &1 & \ldots & 1 & \ldots & 1 \\
  \end{array},
\right)\]
где $r=2^n-1$, $1\leq i\leq r-1$, $\xi$ -– примитивный элемент $F_{2^n}$ (см. \cite{Nurutdinov}). Таким образом, зная значения отображения $\hat{\lambda}^P$ в точках $F_{2^n}\times F_{2^n}$, можно построить многочлен $f_P (x_P,q_P )=\sum\limits_{i,j=0}^r h_{ij}^P x_P^j q_P^i$, где на вход полинома в качестве значений переменной $x_P$ подается элемент поля, соответствующий реализации случайной величины $u^P$, а в качестве $q_P$ –- элемент поля, соответствующий $x_i$.

\subsection{Структурная схема и полиномиальное представление скрытой полумарковской модели типа Фергюсона.}
Для скрытой полумарковской модели фергюсоновского типа построим полиномиальное представление. Для этого по каждой из матриц $A$,$B$ и $F$ определим полином так, как это было сделано в предыдущем разделе для абстрактной прямоугольной матрицы. Итак, поскольку матрицы $A$,$B$ и $F$ являются стохастическими по строкам, согласно \cite{ZahNurSokShal}, \cite{Pospelov}, они могут быть представлены в виде выпуклых линейных комбинаций простых матриц:
\begin{equation}\label{eq:chapt2_Ferguson:expansion_A}
A=\sum\limits_{k=1}^{l_A}p_k^A  M^A (u_k^A ), \;\; l_A\leq N^2-N+1,
\end{equation}
\begin{equation}\label{eq:chapt2_Ferguson:expansion_B}
B=\sum\limits_{k=1}^{l_B}p_k^B  M^B (u_k^B ), \;\; l_B\leq N(M-1)+1,	
\end{equation}
\begin{equation}\label{eq:chapt2_Ferguson:expansion_F}
F=\sum\limits_{k=1}^{l_F}p_k^F  M^F (u_k^F ), \;\; l_F\leq N(L-1)+1,
\end{equation}
где
$M^A (u_k )=\{\mu_{ij}^A (u_k^A)\}_{i,j=1}^{N,N}$, $M^B (u_k)=\{\mu_{ij}^B (u_k^B)\}_{i,j=1}^{N,M}$, $M^F (u_k)=\{\mu_{ij}^F (u_k^F)\}_{i,j=1}^{N,L}$
-– простые матрицы размеров $N\times N$, $N\times M$, $N\times L$ соответственно, причем
$$0\leq p_k^A\leq 1,  \sum\limits_{k=1}^{l_A}p_k^A =1,$$
$$0\leq p_k^B\leq 1 ,  \sum\limits_{k=1}^{l_B}p_k^B =1,$$
$$0\leq p_k^F\leq 1,  \sum\limits_{k=1}^{l_F}-p_k^F =1.$$
Используя (\ref{eq:chapt2_Ferguson:expansion_A}), построим отображение $\Phi^A$ типа (\ref{eq:chapt2_Ferguson:general_Phi}), ставящее в соответствие матрице $A$ такую случайную величину $u^A$, которая принимает значения на некотором множестве $U^A$ с $|U^A |=l_A$, и распределенную по следующему закону:
$$\begin{tabular}{c|c|c|c}
    $u_1^A$ & $u_2^A$ & \ldots & $u_{l_A}^A$ \\
        \hline
    $p_1^A$& $p_2^A$ & \ldots & $p_{l_A}^A$ \\
  \end{tabular}
$$
Определим отображение $\lambda^A:U^A\times S\rightarrow S$, такое что $\lambda^A (u^A,S_i)=S_j$, если $\mu_{ij}^A (u^A)=1$.

Применяя рассуждения, аналогичные вышеприведенным, по разложениям (\ref{eq:chapt2_Ferguson:expansion_B}) и (\ref{eq:chapt2_Ferguson:expansion_F}) определим соответственно отображения $\Phi^B$ и $\Phi^F$, случайные величины $u^B$ со значениями из множества $U^B$ ($|U^B |$=$l_B$) и $u^F$ со значениями из множества $U^F$ ($|U^F|=l_F$), распределенные по следующим законам:
$$\begin{tabular}{c|c|c|c}
    $u_1^B$ & $u_2^B$ & \ldots & $u_{l_B}^B$ \\
        \hline
    $p_1^B$& $p_2^B$ & \ldots & $p_{l_B}^B$ \\
  \end{tabular},
$$
$$\begin{tabular}{c|c|c|c}
    $u_1^F$ & $u_2^F$ & \ldots & $u_{l_F}^F$ \\
        \hline
    $p_1^F$& $p_2^F$ & \ldots & $p_{l_F}^F$ \\
  \end{tabular}
$$
Далее по (\ref{eq:chapt2_Ferguson:expansion_B}) построим отображение $\lambda^B:U^B\times S\rightarrow V$, такое что $\lambda^B (u^B,S_i)=v_j$, при $\mu_ij^B (u^B)=1$. В свою очередь по (\ref{eq:chapt2_Ferguson:expansion_F}) определим отображение $\lambda^F:U^F\times S\rightarrow D$ такое, что  $\lambda^F (u^F,S_i)=d_j$, при $\mu_{ij}^F (u^F)=1$.

Установим соответствие между элементами множеств $U^A$, $U^B$, $U^F$, $S$, $V$, $D$ и элементами поля Галуа: выберем минимальное натуральное $n$, для которого
$$2^n\geq max\{l_A,l_B,l_F,N,M,L\}$$
и закодируем элементы множеств $U^A$, $U^B$, $U^F$, $S$, $D$, $V$ элементами поля $F_{2^n}$. Согласно предыдущему разделу для каждого из отображений $\hat{\lambda}^A$,$\hat{\lambda}^B$ и $\hat{\lambda}^F$, действующих из $F_{2^n}\times F_{2^n}$ в $F_{2^n}$ и кодирующих $\lambda^A$,$\lambda^B$ и $\lambda^F$, можно построить единственный полином вида (\ref{eq:chapt2_Ferguson:general_polinom}). Обозначим эти полиномы $f_A (x_A,q_A)$, $f_B (x_B,q_B)$ и $f_F (x_F,q_F)$ соответственно.

Полиномиальной моделью скрытой полумарковской модели типа Фергюсона назовем систему
$$\Pi M=(u^A,u^B,u^F,f_B (x_B,f_A (x_A,q_A )),f_F (x_F,f_A (x_A,q_A )),\pi),$$
в которой $u^A$,$u^B$ и $u^F$ –- случайные величины, определяемые по разложениям матриц $A$, $B$ и $F$ на линейные комбинации простых матриц аналогично (\ref{eq:chapt2_Ferguson:general_expansion}), значения которых закодированы элементами поля $F_{2^n}$.
Структурная схема автомата, реализующего полиномиальное представление скрытой полумарковской модели фергюсоновского типа $\Delta$, представлена на рисунке \ref{fig:chapt2_Ferguson:scheme}.

\begin{center}\label{fig:chapt2_Ferguson:scheme}
  \includegraphics[height=100mm]{/part2/Structural_model.jpg}
%TODO:Сделать рисунок в pdf формате
%TODO:Сделать нумерацию рисунков
 % Рис.1.
 Структурная схема автомата, реализующего полиномиальное представление скрытой полумарковской модели типа Фергюсона.
  \end{center}

В схеме можно выделить шесть основных блоков, а именно укрупненные блоки «$A$», «$B$», «$F$», соответствующие матрицам $A$,$B$,$F$ модели $Delta$ (см. (\ref{eq:2.2.2:model})); управляющий «Блок $Y$» и вспомогательные блоки: «Блок задержки 1», «Блок задержки 2». Укрупненный «Блок $A$», состоящий из генератора случайной величины $u^A$ «ГСВ $u^A$» и блока $f_A (x_A,q_A)$, отвечает за генерацию текущего состояния модели. Укрупненный «Блок $F$» состоит из генератора случайной величины $u^F$ «ГСВ $u^F$» и блока $f_F (x_F,q_F)$, производит генерацию длительности в выбранном состоянии и тем самым определяет количество запусков укрупненного «Блока $B$». Укрупненный «Блок $B$» состоит из генератора случайной величины $u^B$ «ГСВ $u^B$» и блока $f_B (x_B,q_B)$ и возвращает на выходе символ.

Опишем работу автомата. Блок «ГСВ $u^A$» генерирует значение случайной величины $u^A$ в соответствии с распределением. Сгенерированное значение подается на вход блока $f_A (x_A,q_A)$ в качестве $x_A$, а в качестве $q_A$ подается элемент поля $F_{2^n}$, соответствующий текущему состоянию, в первый момент времени определяемому по вектору $\pi$. Значение полинома $f_A (x_A,q_A)$, представляющее собой новое состояние автомата, подается на вход блока $f_F (x_F,q_F)$ в качестве переменной $q_F$, а также «Блока задержки 1» и «Блока задержки 2». Одновременно с этим блок «ГСВ $u^F$» генерирует значение случайной величины $u^F$ в соответствии со своим распределением. Это значение поступает на вход полинома $f_F (x_F,q_F)$ в качестве $x_F$, а на выходе получается длительность $d$, которая подается на вход управляющего блока «$Y$» и определяет текущее число запусков укрупненного «Блока $B$». «Блок задержки 2» выполняет задержку выходного сигнала блока $f_A (x_A,q_A)$ так, чтобы он поступил на вход блока «$Y$» после того, как отработает блок $f_F (x_F,q_F)$. «Блок $Y$» передает выход блока $f_A (x_A,q_A)$ в качестве переменной $q_B$ подблока $f_B (x_B,q_B)$ укрупненного блока «$B$», а в качестве $x_B$ подается реализация случайной величины $u^B$, сгенерированная собственным генератором в соответствии с распределением. На выходе «$B$» выдает символ $\tilde{v}_i$. Отметим, что укрупненный «Блок B» запускается не один, а $d$ раз, и его запуски управляются блоком «$Y$». Таким образом, текущее состояние порождает последовательность выходных символов длины $d$. «Блок задержки 1» выполняет задержку выходного сигнала блока $f_A (x_A,q_A)$ так, чтобы он поступил на вход $f_A (x_A,q_A)$ после того, как $d$ раз отработает укрупненный «Блок $B$».

\begin{example} Проиллюстрируем предложенный подход к построению полиномиального представления скрытой полумарковской модели типа Фергюсона. Для простоты алфавит состояний, алфавит длительностей и выходной алфавит принимаются бинарными. Рассмотрим скрытую полумарковскую модель фергюсоновского типа $\lambda$ вида \ref{chapt2_Ferguson_model:def}, где
$S = \{S_1,S_2\}$, $V=F_2=\{0,1\}$, $D=\{1,2\}$,
\[A=\left(
      \begin{array}{cc}
        0.9 & 0.1 \\
        0.2 & 0.8 \\
      \end{array}
    \right);
   B=\left(
      \begin{array}{cc}
        0.1 & 0.9 \\
        0.3 & 0.7 \\
      \end{array}
    \right);
    F=\left(
      \begin{array}{cc}
        0.4 & 0.6 \\
        0.5 & 0.5 \\
      \end{array}
    \right);
    \pi=\left(\begin{array}{c}
      0.3 \\
      0.7
    \end{array}\right).
\]

Представим стохастические матрицы $A$,$B$ и $F$ в виде выпуклых линейных комбинаций простых матриц (см. \ref{eq:chapt2_Ferguson:general_expansion}, \ref{eq:chapt2_Ferguson:expansion_A}, \ref{eq:chapt2_Ferguson:expansion_B}, \ref{eq:chapt2_Ferguson:expansion_F}) по алгоритму из \cite{Pospelov} с. 26:
\[A=0.8\cdot \left(\begin{array}{cc}
               1 & 0 \\
               0 & 1
             \end{array}\right)+0.1\cdot \left(\begin{array}{cc}
               0 & 1 \\
               1 & 0
             \end{array}\right)+ 0.1\cdot \left(\begin{array}{cc}
               1 & 0 \\
               1 & 0
             \end{array}\right),\]
\[B=0.7\cdot \left(\begin{array}{cc}
               0 & 1 \\
               0 & 1
             \end{array}\right)+0.2\cdot \left(\begin{array}{cc}
               0 & 1 \\
               1 & 0
             \end{array}\right)+ 0.1\cdot \left(\begin{array}{cc}
               1 & 0 \\
               1 & 0
             \end{array}\right),\]
\[F=0.5\cdot \left(\begin{array}{cc}
               0 & 1 \\
               1 & 0
             \end{array}\right)+0.4\cdot \left(\begin{array}{cc}
               1 & 0 \\
               1 & 0
             \end{array}\right)+ 0.1\cdot \left(\begin{array}{cc}
               0 & 1 \\
               0 & 1
             \end{array}\right).\]
В нашем случае $l_A=l_B=l_F=3$. По разложениям матриц $A$,$B$,$F$ запишем соответствующие распределения для дискретных случайных величин $u^A$, $u^B$, $u^F$:

\[\begin{tabular}{c|c|c}
  $u_1^A$ & $u_2^A$ & $u_3^A$ \\
    \hline
  $0.8$ & $0.1$ & $0.1$ \\
\end{tabular}\;\;\;
\begin{tabular}{c|c|c}
  $u_1^B$ & $u_2^B$ & $u_3^B$ \\
    \hline
  $0.7$ & $0.2$ & $0.1$ \\
\end{tabular} \;\;\;
\begin{tabular}{c|c|c}
  $u_1^F$ & $u_2^F$ & $u_3^F$ \\
    \hline
  $0.5$ & $0.4$ & $0.1$ \\
\end{tabular}
\]

и определим отображения $\lambda^A$, $\lambda^B$ и $\lambda^F$ в табличном виде:
\[
\begin{tabular}{c|c|c}
  $\lambda^A$ & $S_1$ & $S_2$ \\
    \hline
  $u_1^A$ & $S_1$ & $S_2$ \\
    \hline
  $u_2^A$ & $S_2$ & $S_1$ \\
    \hline
  $u_3^A$ & $S_1$ & $S_1$ \\
\end{tabular} ;\;\;\;
\begin{tabular}{c|c|c}
  $\lambda^B$ & $S_1$ & $S_2$ \\
    \hline
  $u_1^B$ & $1$ & $1$ \\
    \hline
  $u_2^B$ & $1$ & $0$ \\
    \hline
  $u_3^B$ & $0$ & $0$ \\
\end{tabular};\;\;\;
\begin{tabular}{c|c|c}
  $\lambda^F$ & $S_1$ & $S_2$ \\
    \hline
  $u_1^F$ & $2$ & $1$ \\
    \hline
  $u_2^F$ & $1$ & $2$ \\
    \hline
  $u_3^F$ & $2$& $2$ \\
\end{tabular}\]

Теперь необходимо закодировать элементы множеств $U^A$, $U^B$, $U^F$, $S$, $V$, $D$ элементами поля Галуа. Минимальное натуральное $n$, для которого выполняется
$$2^n\geq max\{l_A,l_B,l_F,N,M,L\},$$
равно 4. Зафиксируем неприводимый многочлен $m(x)=x^2+x+1$ над полем Галуа $F_{2^2}$. Тогда $F_{2^2}=\{0,1,\xi,\xi^2\}$, где $\xi$ – примитивный элемент. Закодируем элементы множеств $U^A$, $U^B$, $U^F$, $S$, $V$, $D$ элементами поля $F_{2^2}$:

$$S=\{S_1,S_2\}\rightarrow\{0,1\},$$
$$F_2=\{0,1\}\rightarrow\{0,1\},$$
$$ D=\{1,2\}\rightarrow\{0,1\},$$
$$U^A=\{u_1^A,u_2^A,u_3^A \}\rightarrow\{0,1,\xi\},$$
$$U^B=\{u_1^B,u_2^B,u_3^B \}\rightarrow{0,1,\xi},$$
$$U^F=\{u_1^F,u_2^F,u_3^F \}\rightarrow{0,1,\xi}.$$

По $\lambda^A$, $\lambda^B$ и $\lambda^F$  запишем отображения $\hat{\lambda}^A$,$\hat{\lambda}^B$ и $\hat{\lambda}^F$, используя кодировку полем Галуа $F_{2^2}$ и доопределяя их нулями на недостающих элементах.
\[\begin{tabular}{c|c|c|c|c}
  $\hat{\lambda}^A$ & $0$ & $1$ & $\xi$ & $\xi^2$\\
    \hline
  $0$ & $0$ & $1$ & $0$ & $0$ \\
    \hline
  $1$ & $1$ & $0$ & $0$ & $0$ \\
    \hline
  $\xi$ & $0$ & $0$ & $0$ & $0$ \\
    \hline
  $\xi^2$ & $0$ & $0$ & $0$ & $0$ \\
\end{tabular};\;\;\;
\begin{tabular}{c|c|c|c|c}
  $\hat{\lambda}^B$ & $0$ & $1$ & $\xi$ & $\xi^2$\\
    \hline
  $0$ & $1$ & $1$ & $0$ & $0 $\\
    \hline
  $1$ & $1$ & $0$ & $0$ & $0$ \\
    \hline
  $\xi$ & $0$ & $0$ & $0$ & $0$ \\
    \hline
  $\xi^2$ & $0$ & $0$ & $0$ & $0$ \\
\end{tabular};\;\;\;
\begin{tabular}{c|c|c|c|c}
  $\hat{\lambda}^F$ & $0$ & $1$ & $\xi$ & $\xi^2$\\
    \hline
  $0$ & $1$ & $0$ & $0$ & $0$ \\
    \hline
  $1$ & $0$ & $1$ & $0$ & $0$ \\
    \hline
  $\xi$ & $1$ & $1$ & $0$ & $0$ \\
    \hline
  $\xi^2$ & $0$ & $0$ & $0$ & $0$ \\
\end{tabular}
\]
Для каждого из отображений $\hat{\lambda}^A$,$\hat{\lambda}^B$ и $\hat{\lambda}^F$, действующих из $F_{2^2}\times F_{2^2}$ в $F_{2^2}$, построим полином вида (4). Так, полином $f_A (x_A,q_A)$, соответствующий $\hat{\lambda}^A$, имеет вид:
$$f_A (x_A,q_A )=\sum\limits_{i,j=0}^3 h_{ij}^A x_A^j q_A^i,$$
где матрица коэффициентов $H^A=\{h_ij^A \}_{i,j=0}^3$ определяется формулой
$$H^A=C^{-1} Z^A {C^{-1} }^T,$$
матрица $C^{-1}$ в нашем случае имеет вид
$$C^{-1}=\left(
  \begin{array}{cccc}
    1 & 0 & 0 & 0 \\
    0 & 1 & \xi^2 & \xi \\
    1 & 1 & \xi & \xi^2 \\
    1 & 1 & 1 & 1 \\
  \end{array}
\right),$$

а матрица $Z^A$, определяемая значениями $\hat{\lambda}^A$ на элементах $F_{2^2}$, равна
$$Z^A=\left(
  \begin{array}{cccc}
    0 & 1 & 0 & 0 \\
    1 & 0 & 0 & 0 \\
    0 & 0 & 0 & 0 \\
    0 & 0 & 0 & 0 \\
  \end{array}
\right).$$
Тогда
$$H^A=\left(
  \begin{array}{cccc}
    0 & 1 & 1 & 1 \\
    1 & 0 & 0 & 1 \\
    1 & 0 & 0 & 1 \\
    1 & 1 & 1 & 0 \\
  \end{array}
\right).$$

Таким образом:
$$f_A (x_A,q_A )=q+q^2+q^3+x+xq^3+x^2+x^2 q^3+x^3+x^3 q+x^3 q^2.$$
Аналогично по отображениям $\hat{\lambda}^B$ и $\hat{\lambda}^F$ построим многочлены $f_B (x_B,q_B )$ и $f_F (x_F,q_F )$:
$$f_B (x_B,q_B )=1+q+q^2+x+xq^3+x^2+x^2 q^3+x^3 q+x^3 q^2+x^3 q^3,$$
\begin{eqnarray}f_F (x_F,q_F )=& 1+q^3+\xi^2 x+(1+\xi^2 )xq+(1+\xi^2 )xq^2+xq^3+ \nonumber\\ &\xi x^2+(1+\xi) x^2 q  +(1+\xi) x^2 q^2+x^2 q^3.\nonumber\end{eqnarray}
Определив полиномы $f_A (x_A,q_A )$, $f_B (x_B,q_B )$ и $f_F (x_F,q_F )$, мы фактически построили полиномиальное представление рассматриваемой фергюсоновской скрытой полумарковской модели.
\end{example}

%\begin{center}
%\textbf{Сведения о марковских цепях, вероятностных автоматах и полиномах.
%}\end{center}
%Приведем необходимые сведения из теории вероятностных автоматов и теории цепей Маркова.
%
%\textbf{Определение 0.} \emph{автономного вероятного автомата.}
%
%\textbf{Определение 0.} \emph{автономного вероятного автомата без выхода.}
%
%\textbf{Определение 1.} \emph{Конечной однородной цепью Маркова} назовем тройку
%$$\Gamma = (S, P, \pi),$$
%где $S=\{S_1, S_2, ..., S_N \}$ --- алфавит состояний цепи Маркова;
%$P=\{p_{ij}\}_{i,j=1}^{N}$ --- стохастическая матрица размера $N\times N$, называемая матрицей переходных вероятностей;
%$\pi=\{\pi_i\}_{i=1}^{N}$ --- вектор начального распределения вероятностей состояний.
%
%В работе \cite{ZahNurShal} предлагается структурная схема конечной однородной Марковской цепи как вероятностного автомата без выхода (Рис. 1).
%
%\begin{center}
%  \includegraphics[height=40mm]{/part2/struct0.pdf}
%
%  Рис.1.Структурная схема конечной однородной Марковской цепи.
%  \end{center}
%
%Блок ГСВ выполняет функцию генератора случайной величины $Q$, а функция переходов $\lambda(q,s)$ строится следующим образом. По теореме  о  представлении квадратной стохастической матрицы выпуклой линейной комбинацией простых матриц (см. \cite{Bukharaev} c. 25, \cite{Poselov} c.26) матрица $P$ может быть представлена в виде:
%$$P=\sum \limits_{k=1}^{l_s} p_k M(q_k),\;\;\; l_s\leq N^2-N+1, $$
%где $M(q_k)$ --- простая матрица размера $N\times N$. Определим отображение $\lambda : Q\times S\rightarrow S$ такое что $\lambda(q,s_i)=s_j,$ если в матрице $M(q)$ на позиции $i,j$ стоит 1, т. е. $\pi_{ij}=1$.($q$ --- случайная величина, $M(q)=\{\pi_{ij}\}_{i,j=1}^{N,N}$).
%
%Имеет место лемма \cite{Nurutdinov}.
%
%\textbf{Лемма.} Пусть $G=F_{2^n}$, а $\varphi:G\times G\longrightarrow G$ --- произвольная функция от двух переменных, отображающая $G\times G$ в $G$, тогда существует единственный полином вида
%\begin{equation}\label{eq_pol}
%f(x,q)=\sum\limits_{i,j=0}^r a_{ij} x^j q^i, \;\; r=2^n-1,
%\end{equation}
%где $x,q,a_{ij}\in G, n$ определяется условием $l\leq 2^n-1$, являющийся представлением отображения $\varphi$ в том смысле, что $f(c,d)=\varphi(c,d)$ для всех $c,d\in G\times G$.
%
%Матрица коэффициентов многочлена \ref{eq_pol} определяется из следующего соотношения:
%$$A=C^{-1}Y(C^{-1})^T,$$
%где $Y=\{y_{ij}\}_{i,j=0}^{r-1}$ матрица значений отображения $\varphi$ на элементах поля $G$, а $C^{-1}$ имеет следующий вид \cite{Nurutdinov}:
%
%\begin{equation}C^{-1}=
%\left(
%  \begin{array}{ccccccc}
%    1 & 0 & 0 & ... & 0 & ... & 0 \\
%    0 & 1 & \xi^{r-1} & ... & \xi^{(r-1)i mod (r)} & ... & \xi \\
%    ... & ... & ... & ... & ... & ... & ... \\
%    0 & 1 & \xi^2 & ... & \xi^{2 i mod (r)} & ...& \xi^{r-2} \\
%    0 & 1 & \xi & ... & \xi^{i} & ...& \xi^{r-1} \\
%    1 & 1 & 1 & ... & 1 & ... & 1 \\
%  \end{array}
%\right)
%\end{equation}
%где $r=2^n-1, 1\leq i\leq r-1$, $\xi$ --- примитивный элемент $G$.
%
%В работе \cite{Nurutdinov} предлагается представление функции $\lambda(q,s)$ полиномом над полем $F_{2^n}$. Сформулируем следующую теорему из \cite{Nurutdinov}.
%
%\textbf{Теорема.} Пусть $G=F_{2^n}$ и заданы
%$$f(x,q)=\sum \limits_{i,j=0}^r a_{ij}x^j q^i, \;\; r=2^n-1, a_{ij},x,q\in G,$$
%с множеством $\{x_i\}, i=1,...,l,$ значений переменной $x$ и множеством $\{q_j\}, j=1,...,m$ значений переменной $q$, случайная величина $\hat{\mu}$ с множеством значений $\{\mu_i\}\subset \{x_i\}$ и со стохастическим вектором $\bar{P}$ и вектор $\pi_0$.
%
%Тогда последовательность вычисленных значений полинома $f(x,q)$ является реализацией простой однородной цепи Маркова с множеством состояний $\{q_j\}$, описываемой стохастической матрицей $P$ размера $|\{q_j\}|$, элементы которой однозначно определяются вектором $\bar{P}$ и полиномом $f(x,q)$.
%
%%\emph{Лемма и вывод коэффициентов для s-переменных.}
%
%\begin{center}
%\textbf{Структурная схема и полиномиальное представление скрытой марковской модели.
%}\end{center}
%Скрытой марковской моделью, следуя Рабинеру \cite{Rabiner}, будем называть пятерку: $$\lambda=(S, V, A, B,\pi),$$
%где
%$S=\{S_1, S_2, ..., S_N \}$ --- алфавит состояний;
%$A=\{a_{ij}\}_{i,j=1}^{N}$ --- матрица переходных вероятностей,
%где $a_{ij} = P[q_t=S_j|q_{t-1}=S_i]$, $q_t$ -- состояние модели в момент $t$;
% $\pi=\{\pi_i\}_{i=1}^{N}$ --- вектор начального распределения вероятностей состояний, где $\pi_i=P[q_1=S_i]$;
%  $V=\{v_1,v_2,...,v_M \}$ --- алфавит наблюдаемых символов;
%  $B=\{b_{ij}\}_{i,j=1}^{N, M}$ --- матрица распределений вероятностей появления наблюдаемых символов, где $b_{jk}=b_j(k) = P[r_t= v_k | q_t = S_j]$, $r_t$ -- символ, наблюдаемый в момент времени $t$.
%
%  Скрытая марковская модель представляет собой автономный вероятностный автомат с выходом следующего вида \cite{ZahNurShal}:
%  \begin{equation}
%  \label{eq_PAwithOutput}
%  A=(S, A, \pi, V, \mu),\;\;\;
%  \end{equation}
%  где
%$S=\{S_1, S_2, ..., S_N \}$ --- конечное множество состояний;
%$A$ --- стохастическая матрица размера $N\times N$;
%$\pi$ --- n-мерный стохастический вектор, задающий начальное распределение вероятностей состояний;
%$V=\{v_1,v_2,...,v_M \}$ --- конечный выходной алфавит;
%$\mu$ ---функция выхода, задаваемая стохастической матрицей $B=\{b_{ij}\}_{i,j=1}^{N, M}$  размера $N\times M$,
%где элемент $b_{ij}$ определяет вероятность появления буквы $v_j$ при условии, что $A$ находится в состоянии $s_i$.
%
%Рассмотрим структурную модель описанного автономного вероятностного автомата. Будем использовать подход структурного синтеза вероятностного автомата, основанный на представлении вероятностного автомата в виде последовательностной композиции управляемого генератора дискретной случайной величины и конечного детерминированного автомата\cite{ZahNurShal}.
%
%Для представления автомата структурной моделью по теореме о представлении квадратной стохастической матрицы выпуклой линейной комбинацией простых матриц (см. например \cite{Bukharaev},c. 26) записываем матрицу $A$ в виде:
%$$A=\sum \limits_{k=1}^{l_s} p_k M(q_k),\;\;\; l_s\leq N^2-N+1, $$
%$M(q_k)$ --- простая матрица размера $N\times N$. Определим отображение $\lambda : Q\times S\rightarrow S$ такое что $\lambda(q,s_i)=s_j,$ если в матрице $M(q)$ на позиции $i,j$ стоит 1, т. е. $\pi_{ij}=1$.($q$---случайная величина, $M(q)=\{\pi_{ij}\}_{i,j=1}^{N,N}$).
%
%По аналогии по теореме о представлении прямоугольной стохастической матрицы выпуклой линейной комбинацией простых матриц представим
%$$B=\sum \limits_{k=1}^{l_v} p^\prime_k M^\prime(q^\prime_k),\;\;\; l_v\leq N(M-1), $$
%$M^\prime(q_k)$ --- простая матрица размера $N\times M$. Определим отображение $\delta : Q\times S\rightarrow S$ такое что $\delta(q^\prime,s_i)=v_j,$ если в матрице $M^\prime(q^\prime)$ на позиции $i,j$ стоит 1, т. е. $\pi^\prime_{ij}=1$.($q^\prime$---случайная величина, $M^\prime(q^\prime)=\{\pi^\prime_{ij}\}_{i,j=1}^{N,M}$).
%
%Таким образом можно представить автономный вероятностный автомат $A$ структурной схемой, изображенной на рисунке 3.
%
%\begin{center}
%  \includegraphics[height=50mm]{/part2/struct.pdf}
%
%  Рис.3. Структурная схема автономного вероятностного автомата, соответствующего скрытой марковской модели.
%  \end{center}
%  Работа такой схемы происходит следующим образом. Генератор случайной величины $Q$ генерирует дискретную случайную величину
%
%  \begin{center}
%  \begin{tabular}{l|c|c|r}
%    $q_1$ &$ q_2$ & ... & $q_{l_s}$ \\
%    \hline
%    $p_1$ & $p_2$ & ... & $p_{l_s}$ \\
%  \end{tabular}
%    \end{center}
%   Значения $q_k$, $k=\overline{1,l_s}$ поступают на вход блока $\lambda$ с вероятностями $q_k$. Блок реализует функцию перехода между состояниями, которая задается по матрице $M(q_k)$ как было рассмотрено выше. Далее генератор случайной величины $Q^\prime$ генерирует дискретную случайную величину
%
%  \begin{center}
%  \begin{tabular}{l|c|c|r}
%    $q^\prime_1$ &$ q^\prime_2$ & ... & $q^\prime_{l_s}$ \\
%    \hline
%    $p^\prime_1$ & $p^\prime_2$ & ... & $p^\prime_{l_s}$ \\
%  \end{tabular}
%    \end{center}
%значения которой $q^\prime_k$, $k=\overline{1,l_s}$ поступают на вход блока $\delta$ с вероятностями $q^\prime_k$. Блок реализует функцию выхода, которая задается по матрице $M(q^\prime_k)$ как было рассмотрено выше.
%
%Применяя лемму из раздела 1 можем представить функции $\lambda(q,s)$ и $\delta(q^\prime,s)$ в виде полиномов. Выберем наименьшее $n$ так, чтобы выполнялось: $2^n\geq \mid Q\mid$, $2^n\geq \mid Q^\prime\mid$, $2^n\geq \mid S\mid$. Элементы множеств $Q, Q^\prime, S$ закодируем элементами поля $G=F_{2^n}$. Получим, что отображения $\lambda(q,s)$ и $\delta(q^\prime,s)$ определены на $G\times G$ со значениями в $G$ и могут быть представлены полиномами вида \ref{eq_pol}.Таким образом задание скрытой марковской модели эквивалентно заданию последовательностной комбинации двух полиномов над полем $G$.
%
%\textbf{Теорема \cite{ZahNurSokShal}}
%Последовательность состояний процесса, заданного \ref{eq_PAwithOutput}, можно представить последовательностью значений функций $\psi=f_2\bullet f_1$ --- суперпозиции двух полиномов вида (\ref{eq_pol}) над полем $GF(2^n),$ где $n$ --- наименьшее целое, удовлетворяющее условию $2^n\geq max(l_s,l_v)$.
%
%
%\begin{center}
%\textbf{Структурная схема и полиномиальное представление скрытой полу-марковской модели.}
%\end{center}
%
%Рассмотрим частный случай общей скрытой полу-марковской модели, предложенной Ю в \cite{Yu}, так называемую скрытую марковскую модель с явно заданной функцией плотности длительности состояний \cite{Rabiner}.
%
%Скрытой марковской моделью с явно заданной функцией плотности длительности состояний будем называть семерку:
%\begin{equation}
%\label{EDHMM}
%\lambda = \{S, A, \pi, V, B, D, F\},
%\end{equation}
%где первые 5 параметров аналогичны параметрам скрытой марковской марковской модели, $D=\{d_i\}_{i=1}^L$ - алфавит возможных длительностей мощности $L$, а матрица $F$ размера $N\times L$ имеет следующий вид:
%
%$$F=
%        \left(\begin{array}{cccc}
%           P(d_1|S_1) & P(d_2|S_1) & \ldots & P(d_L|S_1) \\
%           P(d_1|S_2) & P(d_2|S_2) & \ldots & P(d_L|S_2) \\
%           \vdots & \vdots & \ddots & \vdots \\
%           P(d_1|S_N) &P(d_2|S_N) & \ldots &P(d_L|S_N)
%        \end{array}\right),$$
%где элемент $f_{ij}$ определяет вероятность выбора длительности $d_j$ при условии, что $\lambda$ находится в состоянии $S_i$.
%
%Отметим, что матрица $F$ является стохастической по строкам (элементы неотрицательны и сумма элементов каждой строки равна 1 \cite{Prasolov}, с. 355). Тогда она может быть представлена в виде выпуклой линейной комбинации не более чем $l_d$ простых матриц:
%$$F=\sum \limits_{k=1}^{l_d} p^d_k M^d(q^d_k),\;\;\; l_d\leq N(L-1), $$
%$M^d(q^d_k)$ --- простая матрица размера $N\times L$. Определим отображение $\gamma : Q^d\times S\rightarrow D$ такое что $\gamma(q^d,s_i)=d_j,$ если в матрице $M^d(q^d)$ на позиции $i,j$ стоит 1, т. е. $\pi^d_{ij}=1$.($q^d$---случайная величина, $M^d(q^d)=\{\pi^d_{ij}\}_{i,j=1}^{N,L}$).
%
%Структурная схема автомата, соответствующего скрытой марковской модели с явно заданной функцией плотности длительности состояний, представлена на рисунке 4 \begin{center}
%  \includegraphics[height=70mm]{/part2/struct3.pdf}
%
%  Рис.4. Структурная схема автомата, соответствующего скрытой марковской модели с явно заданной функцией плотности длительности состояний.
%  \end{center}
%
%Опишем работу такого автомата. Как и в случае скрытой марковской модели генератор случайной величины $Q^s$ генерирует дискретную случайную величину
%
%  \begin{center}
%  \begin{tabular}{l|c|c|r}
%    $q^s_1$ &$ q^s_2$ & ... & $q^s_{l_s}$ \\
%    \hline
%    $p^s_1$ & $p^s_2$ & ... & $p^s_{l_s}$ \\
%  \end{tabular}
%    \end{center}
%   Значения $q^s_k$, $k=\overline{1,l_s}$ поступают на вход блока $\lambda$. Блок реализует функцию перехода между состояниями, которая задается по матрице $M^s(q^s_k)$ как было рассмотрено выше.
%   Далее генератор случайной величины $Q^d$ генерирует дискретную случайную величину
%
%  \begin{center}
%  \begin{tabular}{l|c|c|r}
%    $q^d_1$ &$ q^d_2$ & ... & $q^d_{l_d}$ \\
%    \hline
%    $p^d_1$ & $p^d_2$ & ... & $p^d_{l_d}$ \\
%  \end{tabular}
%    \end{center}
%значения которой $q^d_k$, $k=\overline{1,l_d}$ поступают на вход блока $\gamma$. Блок реализует выбор длительности состояния $s$, которая задается по матрице $M(q^d_k)$ как было рассмотрено выше.
%
%Далее длительность $d$, полученная на выходе блока $\gamma$, подается на вход блока генератора случайной величины $(Q^v)^d$. В отличие от случайных величин $q^s_k$ и $q^d_k$ случайная величина $q^v$ принимает значения в множестве векторов длины $d$ ($(Q^v)^d$). Таким образом на выходе блока генератора случайной величины $(Q^v)^d$ получается вектор длины $d$, элементы которого генерируются в соответствии с одним и тем же распределением
%
%  \begin{center}
%  \begin{tabular}{l|c|c|r}
%    $q^v_1$ &$ q^v_2$ & ... & $q^v_{l_d}$ \\
%    \hline
%    $p^v_1$ & $p^v_2$ & ... & $p^v_{l_d}$ \\
%  \end{tabular}
%    \end{center}
%Полученная реализация случайного вектора подается на вход блока $\delta$. Блок реализует функцию выхода следующим образом:
%\begin{equation}
%\label{eq_delta}
%\delta:(Q^v)^d\times S \longrightarrow V^d, \;\;\; \delta(\{q^v_i\}_{i=1}^L,S)=\{\delta^\prime(q^v_i,S)\}_{i=1}^L,
%\end{equation}
%
%где $\delta^\prime$ задается по матрице $M^v(q^v_k)$ как было рассмотрено выше.
%
%\textbf{Теорема} (о полиномиальном представлении). Последовательность выходных значений процесса, описанного скрытой марковской моделью с явно заданной плотностью длительности состояний, можно представить последовательностью значений функции $\psi = f_3\cdot f_2 \cdot f_1$, т.е. суперпозиции трех полиномов вида (\ref{eq_pol}) над полем $F_{2^n}$, где $n$ --- наименьшее целое, удовлетворяющее условию $2^n\geq max(l_s,l_v,l_d)$.
%
%\textbf{Доказательство} проведем по аналогии с доказательством теоремы 2 из \cite{ZahNurSokShal}. Как уже было сделано ранее матрице $A$ системы (\ref{EDHMM}) поставим в соответствие отображение $\lambda(q^s, s): Q^s\times S \longrightarrow S$, где $|Q^s|=l_s$. Матрице $F$ системы (\ref{EDHMM}) ставится в соответствие отображение $\gamma(q^d, s): Q^v\times S \longrightarrow S$, где $|Q^d|=l_d$.
%
%Аналогично матрице $B$ системы (\ref{EDHMM}) ставится в соответствие отображение $\delta^\prime(q^v, s): Q^v\times S \longrightarrow S$, где $|Q^v|=l_v$. Определим отображение $\delta:(Q^v)^d\times S \longrightarrow V^d$ вида (\ref{eq_delta}).
%
%\emph{... тут надо подумать... Можно закодировать все последовательности и по такой табличке построить полином, но это не очень хорошо, т к значительно увеличивается мощность поля Галуа}
%
%
%Представим отображения $\lambda(q^s, s)$, $\gamma(q^d, s)$,$\delta(q^v, s)$, соответственно, полиномами $f_1(x_1,q)$, $f_2(x_2,q)$, $f_3(x_3,q)$, где, например, $x_1$ соответствует $q^s$ в $\lambda(q^s, s)$. Наименьшую степень поля $F_{2^n}$ определим из условия $2^n\geq max(l_s,l_v,l_d)$.
%
%\emph{...непонятно про то, как в эту полиномиальную запись вписывается моделирование выходных символов внутри длительности.}

