\section{Скрытая полумарковская $QP$-модель.} \label{chapt2_HSMQPN}

   Использование скрытой марковской модели для описания источника ошибок не всегда удобно в случае $q$-ичного цифрового канала передачи данных $C$ нескольких физических состояний, каждое из которых может длиться несколько отсчетов времени. Это связано с используемым в скрытой марковской модели способом моделирования длительности состояний. Для указанных каналов возникает необходимость явно моделировать длительность состояний. Поэтому математическую модель источника ошибок в таком канале удобно строить на основе скрытых полумарковских моделей.

В этом разделе будет предложена скрытая полумарковская $QP$-модель источника ошибок, объединяющая достоинства марковского подхода к моделированию источников ошибок с преимуществами подхода из \cite{DeMoRGUPS}, \cite{DeMoSevKav}, основанного на использовании квазипериодических последовательностей случайных величин.  В \cite{DeMoRGUPS}, \cite{DeMoSevKav} на основе этого подхода была построена математическая модель источника ошибок канала -- $q$-ичная $QP$-модель, обобщающая многие известные модели, например, модели Турина и Турина--Попова (см. \cite{Turin71}, \cite{DeMoMet1}).

Далее приведем необходимые сведения из теории квазипериодических случайных величин (в подразделе \ref{chapt2_HSMQPN_QP}) и опишем $q$-ичную $QP$-модель источника ошибок (в подразделе \ref{chapt2_HSMQPN_qQP}). Основным результатом раздела является построение в подразделе \ref{chapt2_HSMQPN_HSMQPN} скрытой полумарковской $QP$-модели и иллюстрация ее вложения в общую скрытую полумарковскую модель, представленную в \cite{Yu}.

\subsection{Квазипериодические последовательности случайных величин.}\label{chapt2_HSMQPN_QP}
Изложим сведения из \cite{DeMoRGUPS}, \cite{DeMoSevKav},
необходимые для будущего построения cкрытой полумарковской $QP$-модели источника ошибок.

Пусть $p_{tr}$ -- вероятность достоверной передачи символа в канале $C$ с одним физическим состоянием, а $p_{er} = 1 - p_{tr}$ -- вероятность ошибочной передачи символа. Следуя \cite{DeMoRGUPS}, \cite{DeMoSevKav}, рассмотрим вероятностное пространство
$$S = (\Omega, A, p),$$
где  $\Omega=\{t;e\}$ ($e$ соответствует наличию, а  $t$ - отсутствию ошибки); $A$ -- множество всех подмножеств $\Omega$; $p:A\rightarrow[0,1]$ -- вероятностная функция, определяемая условием: $$p(t)=p_{tr},\;\;\; p(e)=p_{er}.$$

Отрезок числовой оси $\mathbb{R}$ с целочисленными концами $a$ и $b$ $(a<b)$ будем обозначать $[a,b]$, а соответствующий отрезок множества целых чисел $\mathbb{Z}$ обозначим  $[a,b]_{\mathbb{Z}}$. Под длиной $[a,b]_{\mathbb{Z}}$ будем понимать $b-a+1$.

Зададим на отрезке $L=[0,{T-1}]_{\mathbb{Z}}$ дискретной временной оси канала плотность $\rho$, для которой выполняется следующее \textit{условие адаптированности к каналу} $C$:
  \begin{equation}
  \label{chapt2_HSMQPM_QP_addopt_condition}
  \forall i\in L=[0,T-1]_{\mathbb{Z}}: \rho(i)\leq 1/(T\cdot p_{er})\leq1.
  \end{equation}

Далее с помощью $\rho$ будет имитироваться плотность распределения позиций ошибок внутри временного отрезка \emph{L}. Для каждого $i\in L$ рассмотрим вероятностное пространство
$$S_{i}=(\Omega, A, p_{i}),$$
где вероятностная функция $p_{i}$ задана условиями:
$$p_{i}(e)=p(i)\cdot p_{er}\cdot T,  p_{i}(t)=1-p_{i}(e),$$
и определим на $S_{i}$ случайную величину  $\Xi^{(L)}_{i}$, принимающую значения в поле Галуа $\mathbb{F}_{2}=\{0;1\}:$   $$\Xi^{(L)}_{i}(e)=1,  \;\;\; \Xi^{(L)}_{i}(t)=0.$$

Конечную последовательность  $\Xi^{(L)}=\{\Xi^{(L)}_{i}\}_{i\in L}$ назовем \emph{адаптированным  к $q$-ичному каналу эталонным вектором двоичных случайных величин}.

Опишем механизм из \cite{DeMoRGUPS}, позволяющий масштабировать адаптированные к каналу эталонные векторы случайных величин. Рассмотрим на отрезке $L=[0,T - 1]_{\mathbb{Z}}$  адаптированную к каналу C дискретную плотность $\rho$ и соответствующий эталонный вектор случайных величин  $\Xi^{(L)}$. Определим на промежутке $[0,J)\subset \mathbb{R}$, где $J>1/p_{er}$, кусочно-постоянную плотность  $\varphi^{pc}$:
  $$\forall i\in L: \;\;\;\;\; \varphi^{pc}\mid _{(iq,(i+1)q]}=(T/J)\cdot \rho(i) \;\;\; (\text {где \;} q=J/T)$$
и зададим на $M=[0,J-1]_{\mathbb{Z}}$ адаптированную к каналу дискретную плотность:
$$\varphi (j) = \int\limits_{j}^{j+1} \varphi^{pc}(x)dx$$
(см. (\ref{chapt2_HSMQPM_QP_addopt_condition})). Плотность $\rho$, длина временного отрезка \emph{J} и параметр $p_{er}$ определяют набор вероятностных пространств вида
$$S'_{j}=(\Omega,A,p_{j}), \;\;\; j\in M,$$
где $$p'_{j}(e)=\varphi(j)\cdot p_{er}\cdot J, \;\;\;  p'_{j}(t)=1-p'_{j}(e),$$
и  $\varphi$-эталонный вектор случайных величин $\Xi^{(M)}$. Вектор $\Xi^{(M)}$ далее будем называть \emph{масштабным растяжением}  $\varphi$-эталонного вектора  $\Xi^{(L)}$ на отрезок $M=[0,J-1]_{\mathbb{Z}}$.

Представим дискретную временную ось $\mathbb{Z}$ канала $С$ в виде случайной последовательности целочисленных отрезков $$L_{1}, L_{2},..., L_{k},... ,$$
длины которых $T_{k}$ распределены по некоторому закону \emph{f(Т)}, и предположим, что
 $$\forall k: \;\;\;  1/(T_{k}\cdot p_{er})\leq 1.$$

Отрезки $L_{k}$ назовем \emph{квазипериодами}.

Рассмотрим теперь адаптированную к каналу дискретную плотность $\rho$, заданную на эталонном отрезке $L_{0}=[0 , T_{0} -1]_{\mathbb{Z}}$, и соответствующий $\rho$-эталонный вектор случайных величин $\Xi^{(L_{0})}$.

Пусть $\Xi^{(L_{k,0})}$- масштабное растяжение вектора $\Xi^{(L_{0})}$ на отрезок $L_{k}=[0, T_{k} -1]_{\mathbb{Z}}$, а $\Xi^{(L_{k})}=\{\Xi_{i}^{(L_{k})}\}_{i\in L_{k}}$  - сдвиг вектора $\Xi^{(L_{k,0})}=\{\Xi_{i}^{(L_{k,0})}\}_{i\in L_{0}}$  вдоль временной оси на $W_{k}=\sum\limits_{j=1}^{k-1} T_{j} $, то есть ${\Xi_{i+W_{k}}^{(L_{k})}}={\Xi_{i}^{(L_{k,0})}}$, где $i\in [0, T_{k} -1]_{\mathbb{Z}}$.

 Вектор случайных величин $\Xi^{(L_{k})}$ будем называть \emph{масштабным переносом} $\rho$-эталонного вектора $\Xi^{(L_{0})}$ на отрезок $L_{k}$.  На вероятностном пространстве
 \begin{equation}
 \label{chapt2_HSMQPM_QP_probabalistic_space}
 {\Sigma_{i}^{(L_{k})}}=(F_{q},A_{q},{\pi_{i}^{(L_{k})}}), \;\;\; i\in L_{k}
 \end{equation}
 рассмотрим конкатенацию последовательности векторов
 $$\Xi^{(L_{1})}, \Xi^{(L_{2})},..., \Xi^{(L_{k})},...,$$
 которая задает последовательность $\Xi=\{\Xi_{i} \}_{i\in \mathbb{Z}}$ случайных величин. Пусть
 $$\Sigma_{i}(\Omega,A,\pi_{i}), \;\;\; i\in \mathbb{Z} $$
 --- вероятностное пространство типа (\ref{chapt2_HSMQPM_QP_probabalistic_space}), на котором определена случайная величина $\Xi_{i}$. Построенную последовательность  $\Xi=\{\Xi_{i} \}_{i\in \mathbb{Z}}$ будем называть \emph{квазипериодической последовательностью случайных величин с $\rho$-эталонным вектором $\Xi^{(L_{0})}$  и распределением длин квазипериодов $f(T)$}.

\subsection{$q$-ичная $QP$-модель источника ошибок.}\label{chapt2_HSMQPN_qQP}
Используя математический аппарат теории квазипериодических последовательностей случайных величин, опишем математическую модель источника ошибок $q$-ичного симметричного канала передачи данных.

Рассмотрим $q$-ичный симметричный цифровой канал $C$ с одним физическим состоянием. Входными параметрами модели источника ошибок канала $C$ являются:

1) вероятность $P^{er}$ ошибочной передачи байта;

2) адаптированный к каналу $\rho$-эталонный вектор случайных величин $\Xi^{(L_{0})}$;

3) адаптированное к каналу распределение $f(T)$ длин квазипериодов;

4) определенная на вероятностном пространстве ненулевых значений ошибок $S_{q}=(\mathbb{F}_{q}^{\ast}, A_{q}^{\ast}, p_{smb})$ случайной величиной $\zeta$:
$$\zeta(\lambda)=\lambda, \;\;\;\;\; \lambda\in \mathbb{F}_{q}^{\ast}.$$
(Здесь и далее $\mathbb{F}_{q}^{\ast}$ - мультипликативная группа поля Галуа $\mathbb{F}_{q}$, а  $A_{q}^{\ast}$ --- множество всех подмножеств $\mathbb{F}_{q}^{\ast}$).

 Эту модель назовем \textit{математической моделью источника квазипериодических случайных ошибок} ($QP$-моделью) над $q$-ичным каналом. Будем говорить, что канал \textit{находится в математическом $QP$-состоянии}, если его источник ошибок описан $QP$-моделью. В случае постоянства длин всех квазипериодов будем говорить о \textit{математической модели источника периодических случайных ошибок} ($P$-модели).

Опишем процесс моделирования  $q$-ичного потока ошибок на основе построенной модели. Сначала построим так называемую последовательность позиций ошибок, которая генерируется посредством реализации соответствующей квазипериодической последовательности случайных величин $\Xi=\{\Xi_i\}$. Следует отметить, что последовательность $\{\Xi_i\}$ определяет только наличие либо отсутствие ошибки.

После определения позиций ошибок, возникает вопрос об их значениях. В связи с этим рассмотрим вероятностное пространство $$\Sigma_{i}^{\Delta}=(\mathbb{F}_{q},A_{q},p_{i}^{\Delta}),$$
полагая для произвольного $\xi\in \mathbb{F}_{q}$:
 $$p_{i}^{\Delta}(\xi)= \pi_{i}(1)\cdot p_{smb}(\xi),\;\;\; \xi\neq 0,$$
 $$ p_{i}^{\Delta}(0)=\pi_{i}(0).$$

Определим отображение $\tau$: $\mathbb{F}_{2}\times \mathbb{F}^{\ast}_{q}\rightarrow \mathbb{F}_{q}$  условиями:
$$\forall \eta\in \mathbb{F}^{\ast}_{q}: \tau(0,\eta)=0, \;\;\;\;\;\;\forall \eta\in \mathbb{F}^{\ast}_{q}: \tau(1,\eta)=\eta.  $$

На вероятностном пространстве $\Sigma_{i}^{\Delta}$ зададим случайную величину $\Xi^{\Delta}_{i} $ следующим образом:
$$\Xi^{\Delta}_{i}(\xi)=\Xi_{i}(j)\cdot \zeta(\eta),$$
$$ \tau(j,\eta)=\xi.$$

Покажем, что такое определение корректно. Действительно, если $\emph{j = 1}$, то $\forall \eta\in \mathbb{F}^{\ast}_{q}$ \;\;\; $\xi=\eta$. Если же $\emph{j = 0}$, формально полагаем $\eta=1$. При таком предположении $\xi=0$ и $\Xi^{\Delta}_{i}$ определяется корректно.

В математической модели источника квазипериодических случайных $q$-ичных ошибок, то есть в $q$-ичной $QP$-модели, поток ошибок определим как реализацию $q$-ичной последовательности $\Xi^{\Delta}=\{\Xi^{\Delta}_{i}\}_{i\in \mathbb{Z}}$.

Итак, описанная модель задает $q$-ичный поток ошибок, нулевые элементы которого соответствуют отсутствию ошибки в информационном потоке, а ненулевые элементы указывают на значение ошибки.

\subsection{Скрытая полумарковская $QP$-модель}\label{chapt2_HSMQPN_HSMQPN}

Рассмотрим цифровой канал передачи данных $C$, по которому передается информация
в виде последовательностей символов $q$-ичного алфавита, отождествляемого с полем Галуа $F_{q}$.
Будем полагать, что этот $q$-ичный канал имеет $n$ физических состояний $s^{[1]},\,\ldots,\,s^{[n]}$,
каждое из которых описывается математическим $QP$-состоянием. Это означает, что каждому состоянию
$s^{[j]}$ соответствует некоторый источник квазипериодических случайных ошибок, который
задается следующими входными параметрами:
\begin{itemize}
  \item средней вероятностью ошибочной передачи символа $p_{\rm \, er}^{[j]}$;
  \item заданной на эталонном отрезке $L_{0}^{[j]}$  длины $T_{0}^{[j]}$ адаптированной к каналу
плотностью $\rho^{[j]}$  (см. (\ref{chapt2_HSMQPM_QP_addopt_condition})), для которой
$$
\sum_{i=0}^{T^{[j]}-1}\rho^{[j]}(i)=1;
$$
  \item адаптированным к каналу бинарным  $\rho^{[j]}$-эталонным вектором случайных величин $\Xi^{(L_{0}^{[j]})}$;
  \item распределением длин квазипериодов $f^{[j]}(T)$ с математическим ожиданием длины квазипериода $T^{[j]}$,
для которых выполняется условие адаптированности (\ref{chapt2_HSMQPM_QP_addopt_condition});
  \item определенной на вероятностном пространстве ненулевых значений ошибок
$S_{q}^{[j]}=(F_{q}^{*},\, A_{q}^{*},\, p_{\rm \, smb}^{[j]})$ случайной величиной
$\zeta^{[j]}$:\ $\zeta^{[j]}(\lambda)=\lambda,\ \lambda\in F_{q}^{*}$.
(Здесь и далее $F_{q}^{*}$ --- мультипликативная группа поля Галуа $F_{q}$,
а  $A_{q}^{*}$ --- множество всех подмножеств $F_{q}^{*}$).
\end{itemize}

Набор  $\Phi=\{s^{[1]},\, s^{[2]},\,\ldots,\, s^{[n]}\}$ назовем алфавитом состояний канала.
Переход от состояния к состоянию реализуется заданием марковской матрицы переходных вероятностей
\begin{equation}
\label{lb_trans_matr}
K=
        \left(\begin{array}{cccc}
           p_{11} & p_{12} & \ldots & p_{1n} \\
           p_{21} & p_{22} & \ldots & p_{2n} \\
           \vdots & \vdots & \ddots & \vdots \\
           p_{n1} & p_{n2} & \ldots & p_{nn}
        \end{array}\right),
\end{equation}
где $p_{ij}$ --- вероятность перехода канала из состояния $s^{[i]}$ в состояние $s^{[j]}$.
Заметим, что матрица $K$ --- стохастическая, т.~е.
\begin{equation}
\forall\ i,j:\ 0 \leq p_{ij}\leq 1;\ \ \forall\ i:\ \sum _{j=1}^{n} p_{ij} =1.
\end{equation}
Предельные вероятности марковского процесса $P_{\rm \, lim}^{[i]}$  $(i\in [1,\,n]_Z)$ определяются из соотношений:
\begin{equation}
\label{lb_system_equation}
           \left\{
           \begin{array}{rcl}
            \sum\limits_{j=1}^{n}P_{\rm \, lim}^{[j]} & = & 1, \\
             \sum\limits_{j=1}^{n}P_{\rm \, lim}^{[j]}\cdot p_{ji}   & = & P_{\rm \, lim}^{[i]},\ \ i\in [1,n]_Z. \\
           \end{array}
           \right.
\end{equation}

\begin{remark} \rm
В \cite{Bellman} доказано, что система (\ref{lb_system_equation}) разрешима единственным образом только в случае,
если выполнено условие регулярности для  матрицы (\ref{lb_trans_matr}):
 1) у  матрицы $K$ нет характеристических чисел, отличных от единицы и равных по модулю единице, и
 2) единица является простым корнем характеристического уравнения матрицы $K$.
\end{remark}

Будем предполагать, что средняя вероятность ошибочной передачи символа в канале равна $P_{\rm \, er}$.
Введем условие согласования:
$$
P_{\rm \, er}=\sum_{i=1}^{n}P_{\rm \, er}^{[i]}\cdot P_{\rm \, lim}^{[i]}.
$$

Таким образом, мы определили параметры скрытой полумарковской математической модели источника ошибок
$q$-ичного цифрового канала нескольких физических состояний на основе $QP$-модели,
которую будем называть скрытой полумарковской $QP$-моделью.

Опишем теперь процесс моделирования $q$-ичного потока ошибок на основе построенной модели.
Сначала построим последовательность позиций ошибок. Для этого представим дискретную временную ось
в виде последовательности целочисленных отрезков переменной длины
$$
L_{1},\, L_{2},\,\ldots,\, L_{r},\ldots,
$$
где отрезок $L_{r}$ соответствует некоторому состоянию $s^{[j_r]}$, а его длина $T_{r}$
определяется согласно распределению длин квазипериодов для текущего состояния.
Каждому отрезку $L_{r}$  моделью сопоставляется бинарный вектор случайных величин
$\Xi^{(L_{r})}=\{\Xi_{i}^{(L_{r})}\}_{i\in L_{r}}$.
Для произвольного $r \in \{1;\,2;\,\ldots\}$ вектор $\Xi^{(L_{r})}$  является масштабным переносом
на отрезок $L_{r}$ бинарного  $\rho^{[j_r]}$-эталонного вектора случайных величин,
соответствующего  математическому $QP$-состоянию $s^{[j_r]}$.
Теперь рассмотрим последовательность случайных величин $\Xi = \{\Xi_{t}\}_{ t \in Z}$,
определяемую конкатенацией последовательности бинарных векторов
$$
\Xi^{(L_{1})},\,\Xi^{(L_{2})},\,\Xi^{(L_{3})},\,\ldots
$$
Эту последовательность будем называть последовательностью позиций ошибок.

После определения позиций ошибок возникает вопрос о значениях ошибок. Пусть $\sigma$ --- отображение,
ставящее каждому моменту времени $t\in\mathbb{Z}$ номер того состояния, в котором находится канал в этот момент.
По аналогии с (4) для каждого $t\in\mathbb{Z}$ рассмотрим  вероятностное пространство
$\Sigma_{t}=(\Omega,\, A,\,\pi_{t})$ типа (\ref{chapt2_HSMQPM_QP_probabalistic_space}), на котором определена случайная величина $\Xi_{t}$.

Рассмотрим также вероятностное пространство $\Sigma_{t}^{\Delta}=(F_{q},\,A_{q},\,p_{t}^{\Delta})$,
полагая для произвольного $\xi\in F_{q}$:
$$p_{t}^{\Delta}(\xi)= \pi_{t}(1)\cdot p_{\rm \, smb}^{[\sigma(t)]}(\xi),$$
если $\xi\neq 0$, и $p_{\rm \, smb}^{[\sigma(t)]}(0)=\pi_{t}(1)$. Определим отображение
$\tau$: $F_{2}\times F^{*}_{q}\rightarrow F_{q}$  условиями:
$$
\forall\ \eta\in F^{*}_{q}:\ \tau(0,\,\eta)=0,\ \tau(1,\,\eta)=\eta.
$$
Тогда случайную величину $\Xi^{\Delta}_{t} $ на вероятностном пространстве
$$
\Sigma_{t}^{\Delta}=(F_{q},\,A_{q},\,p_{t}^{\Delta})
$$
корректно зададим формулой
$$
\Xi^{\Delta}_{t}(\xi)=\Xi_{t}(j)\cdot \zeta^{[\sigma(t)]}(\eta),\ \ \tau(j,\,\eta)=\xi.
$$

В скрытой полумарковской $QP$-модели поток ошибок определим как реализацию $q$-ичной последовательности
${\Xi^{\Delta}=\{\Xi^{\Delta}_{t}\}_{t\in Z}}$.
Итак, построенная модель задает $q$-ичный поток ошибок, нулевые элементы которого соответствуют
отсутствию ошибки в информационном потоке, а ненулевые элементы указывают на значение ошибки.

Для удобства решения обратных задач (см. \ref{chapt1_Inverse_Problems}) опишем построенную модель источника ошибок в терминах скрытых полумарковских моделей.

\begin{definition} Под скрытой полумарковской QP-моделью (CПМQP-моделью) источника ошибок будем понимать набор $$\lambda =  \{\mathcal{S};\mathcal{D}; A; \Pi; p(d); \rho; \mu ;M ;{\mathbb{F}}_q;B \},$$
параметры которого определяются следующим образом.

1) $\mathcal{S}=\{1,...,N\}$ --- алфавит состояний дискретной полумарковской цепи, $\mathcal{D}=\{1,...,D\}$ -- алфавит возможных длительностей состояний.

2) $A=\{a_{ii^\prime}\}_{i,i^\prime\in \mathcal{S}}$ --- матрица переходных вероятностей, матричный элемент $a_{ii^\prime}$ которой представляют собой вероятность перехода из состояния $i$ в состояние $i^\prime$, то есть
$$\forall i,i^\prime \in \mathcal{S}: \;\;\; a_{ii^\prime} \triangleq P_\nu[S_{[t}=i^\prime|S_{t-1]}=i],$$
где $t$ --- момент времени, когда произошёл переход из обобщённого состояния $(i,d)$ в $(i^\prime,d^\prime)$. Для матрицы $A$ должно также выполняться условие стохастичности, то есть:
$$\forall i,i^\prime \in \mathcal{S}: 0\leq a_{ii^\prime} \leq 1$$
и
$$\forall i \in \mathcal{S}: \sum\limits_{i^\prime\in \mathcal{S}} a_{ii^\prime}=1.$$

3) $\Pi=\{\pi_{i}\}_{i\in \mathcal{S}}$ представляет собой исходное распределение вероятностей состояний. Элемент $\pi_{i}$  --- вероятность того, что система прибывала в состоянии $i$ до начала наблюдений. Таким образом, можно записать:
$$\forall i\in \mathcal{S}:\;\;\; \pi_{i}\triangleq P[S_{0}=i].$$

4) $p(d)=\{p_i(d)\}_{i\in\mathcal{S}}$ --- набор распределений вероятностей длительностей в различных состояниях, где $p_i(d)$ соответствует вероятности наблюдения состояния $i$ на протяжении в точности $d$ моментов времени. Сказанное можно записать в виде:
$$\forall (i,d) \in \mathcal{S}\times \mathcal{D}: \;\;\; p_i(d)\triangleq P[S_{t+1:t+d]}=i|S_{[t+1}=i].$$

5) $\rho=\{\rho_i(l)\}_{i\in\mathcal{S}, l \in L_i}$ --- вектор, составленный из эталонных плотностей, определяемых на эталонных отрезках $L=\{L_i\}_{i\in\mathcal{S}}$ длин $\Delta=\{\delta_i\}_{i\in\mathcal{S}}$, где
$$\forall i\in \mathcal{S}, l \in L_i :\;\;\; 0\leq \rho_i (l)\leq 1$$
и
$$\forall i\in \mathcal{S}:\;\;\; \sum\limits_{l\in L_i} \rho_i(l)=1.$$
$\mu=\{{\mu}_i\}_{i\in\mathcal{S}}$ --- вектор средних вероятностей появления ошибки в различных состояниях, a $M$ --- средняя вероятность появления ошибки в канале. Для эталонных плотностей $\rho_i$ должно также выполняться условие адаптированности к каналу:
$$\forall i\in \mathcal{S}, \forall l \in L_i :\;\;\; \rho_i(l)\leq \frac{1}{\delta_i \mu_i}\leq 1.$$

6) Поле Галуа $F_q$ --- алфавит наблюдаемых символов. $\mathbb{F}^\ast_q$ --- мультипликативная группа поля Галуа $\mathbb{F}_q$. $B=\{b_{i}(k)\}_{i \in \mathcal{S}, k \in \mathbb{F}^\ast_q}$ --- набор распределений вероятностей значений ошибки в состояниях, элемент которого $b_{i}(k)$ представляет собой вероятность наблюдать символ $k$ в состоянии $i$, т.е. можно записать в виде:
$$\forall i \in \mathcal{S},\forall k \in \mathbb{F}^\ast_q :$$
$$\;\;\; b_{i}(k)\triangleq P[k|S_{t}=i].$$
\end{definition}

Отметим, что для параметров СПМQP-модели должны дополнительно выполняться следующие два условия:
\begin{equation}
\label{eq_adopt}
\forall i \in \mathcal{S}, \forall d \in \mathcal{D}: \frac{1}{d \mu_i} \geq 1 \Rightarrow p_i(d)=0.
\end{equation}
\begin{equation}
\label{eq_soglas}
M =\sum\limits_{i \in \mathcal{S}}\mu_i P_i^{\mathrm{lim}},
\end{equation}

\noindent где $P_i^{\mathrm{lim}}$ --- предельные вероятности состояний.

Посредством описанной модели можно производить генерацию потоков ошибок. В нулевой момент времени (то есть до начала генерации последовательности ошибок) с помощью вектора $\Pi$ определяется состояние системы до наступления первого момента времени. Далее для каждого момента времени выполняется следующая последовательность действий:

1) На основе матрицы переходных вероятностей выбирается текущее состояние канала $i$.

2) С использованием распределения вероятностей длительностей $p_i(d)$ в выбранном состоянии определяется длина $d$ временного отрезка, на протяжении которого модель будет находиться в текущем состоянии (то есть длительность текущего состояния).

3) Для каждой точки отрезка выбранной длины вычисляется вероятность наличия в ней ошибки:
\begin{equation}
\label{eq_error_prob}
\forall \theta \in [1,d]: e_{i,\theta}^d = \varphi_i^d(\theta)\mu_i d,
\end{equation}
где
\begin{equation}
\label{eq_varphi}
\varphi_i^d(\theta) = \int\limits_{\theta}^{\theta+1} \varphi_{i,d}^{pc}(x)dx
\end{equation}
и
$$\forall l\in L_i: \;\;\;\;\; \varphi_{i,d}^{pc}\mid _{(lq,(l+1)q]}=\frac{\delta_i}{d}\cdot \rho(i),$$

\noindent где $q=\frac{d}{\delta_i}$. В соответствии с этой вероятностью определяется наличие ошибки на данной позиции.

4) В случае, если ошибка есть, в соответствии с матрицей $B$ генерируется ее значение. В противном случае, на этой позиции будет стоять нулевой элемент.

Построенная СПМQP-модель может быть рассмотрена в рамках общей скрытой полумарковской модели. Для этого введем необходимые уточнения параметров общей скрытой полумарковской модели. Во-первых, в качестве алфавита наблюдаемых символов выбрано поле Галуа $\mathbb{F}_q$; во-вторых, допускается возможность самоперехода, то есть перехода из состояния $i (\in \mathcal{S})$ в него же; в-третьих, вероятность перехода в новое состояние зависит только от предыдущего состояния, а его длительность -- только от него самого, т.е.:
\begin{equation}
\label{eq_initial_alpha}
a_{(i,d)(i^\prime, d^\prime)}=a_{ii^\prime}p_{i^\prime}(d^\prime)
\end{equation}
и, аналогично,
\begin{equation}
\label{eq_initial_pi}
\pi_{i^\prime,d^\prime} = \pi_{i^\prime} p_{i^\prime} (d^\prime);
\end{equation}
в-четвертых, при фиксированном состоянии наблюдения независимы, а их вероятности зависят как от текущего состояния и его длительности, так и от позиции наблюдения внутри текущего временного отрезка;
в-пятых, предполагается условная независимость события, заключающегося в наблюдении в некоторый момент времени $t+1$ состояния $j$ с длительностью $d$, от события, заключающегося в наблюдении последовательности $O_{1:t}$, при условии, что в момент времени $t$ закончилось состояние $i$ длительностью $d^\prime$. По определению условной независимости можно записать:
\begin{equation}
\label{eq_cond_1}
\begin{split}
&P[S_{[t+1,t+d+1]}=j, O_{1:t}|S_{[t-d^\prime+1,t]}=i] \\
&= P[S_{[t+1,t+d+1]}=j|S_{[t-d^\prime+1,t]}=i]P[ O_{1:t}|S_{[t-d^\prime+1,t]}=i];
\end{split}
\end{equation}
в-шестых, предполагается условная независимость события, заключающегося в наблюдении последовательности $O_{t+1,t+d}$, от произведения событий наблюдения последовательности $O_{1:t}$ и окончания в момент времени $t$ состояния $i$ длительности $d^\prime$ при условии, что в момент времени $t+1$ началось состояние $j$ длительностью $d$. Таким образом из определения условной независимости следует, что:
\begin{equation}\label{eq_cond_2}
P[O_{t+1:t+d}|S_{[t+1,t+d+1]}=j, O_{1:t}, S_{[t-d^\prime+1,t]}=i] =
P[O_{t+1:t+d}|S_{[t+1,t+d+1]}=j].
\end{equation}
