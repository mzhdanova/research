\section{Скрытая марковская модель источника ошибок.}\label{chapt2_HMM}
В \ref{chapt1_HMM_Def} рассматривалось определение скрытой марковской модели. В этом разделе покажем, как на основе этой модели можно моделировать источники ошибок в цифровых каналах и как некоторые классические модели источников ошибок вкладываются в скрытую марковскую модель.

Далее будем рассматривать симметричный цифровой канал передачи данных \emph{N} физических состояний. Напомним, что про реальный канал передачи данных говорят, что он находится в \emph{фиксированном физическом состоянии}, если основные параметры его помеховой обстановки относительно стабильны. По этому каналу передается информация в виде последовательностей символов $q$-ичного алфавита, отождествляемого с полем Галуа $\mathbb{F}_q$. Будем обозначать такой канал $C$.

Построим модель источника ошибок в канале $C$ на основе классической скрытой марковской модели, описанной в разделе \ref{chapt1_HMM_Def}. Определим скрытую марковскую модель источника ошибок следующим образом:

1) физические состояния канала будем моделировать алфавитом математических состояний $S=\{S_1, S_2, ..., S_N \}$ мощности \emph{N};

2) вероятности перехода канала из состояния в состояние зададим матрицей переходных вероятностей
$$A=
        \left(\begin{array}{cccc}
           a_{11} & a_{12} & \ldots & a_{1N} \\
           a_{21} & a_{22} & \ldots & a_{2N} \\
           \vdots & \vdots & \ddots & \vdots \\
           a_{N1} & a_{N2} & \ldots & a_{NN}
        \end{array}\right),$$
где $a_{ij} = P[q_t=S_j|q_{t-1}=S_i]$, $q_t$ - состояние канала в момент $t$;

3) зададим вектор начального распределения вероятностей состояний
$$\pi=\{ \pi_1, \pi_2, \ldots, \pi_N \},$$
где $\pi_i=P[q_1=S_i]$ ;

4) в качестве алфавита наблюдаемых символов будем рассматривать конечное поле --- поле Галуа $ \mathbb{F}_q=\{v_0, v_1,\ldots , v_{q-1}\}$;

5) зададим матрицу вероятностей появления наблюдаемых символов $v_k$  в состоянии  $S_j$:
$$B=
        \left(\begin{array}{cccc}
           b_{10} & b_{11} & \ldots & b_{1q-1} \\
           b_{20} & b_{21} & \ldots & b_{2q-1} \\
           \vdots & \vdots & \ddots & \vdots \\
           b_{N0} & b_{N1} & \ldots & b_{Nq-1}
        \end{array}\right),$$
где $b_{jk} = P[r_t= v_k | q_t = S_j]$, $r_t$ - символ, наблюдаемый в момент времени $t$.

Моделирование потока ошибок такой моделью происходит в два этапа.

\textbf{Этап 1.} В соответствии с начальным распределением $\pi$ в первый момент времени и матрицей переходных вероятностей \emph{A} в последующие моделируется состояние канала в текущий момент.

\textbf{Этап 2.} С учетом выбранного состояния исходя из матрицы условных вероятностей \emph{B} генерируется значение ошибки. Понятно, что в силу аддитивности помех появление нулевого символа $v_0=0$ соответствует отсутствию ошибки.

Частными случаями описанной модели являются такие классические модели как модель Гильберта, Гильберта-Эллиота, Фричмана и многие другие. Действительно, модель Гильберта получится из предлагаемой в данном разделе модели при следующих предположениях:

1) рассматривается бинарный (над полем $\mathbb{F}_2$) канал двух состояний;

2) первое состояние считается "хорошим"\; в том смысле, что вероятность ошибки в нем $b_1(1)=0$;

3) вероятность ошибки во втором ("плохом"\;) состоянии $b_2(1)$ полагается равной некоторому $\varepsilon$;

4) накладываются ограничения на матрицу перехода:
$$a_{12}<<a_{11}, \;\;\; a_{21}<<a_{22}$$
(значок $x << y$ используется в том смысле, что $x$ "намного меньше" $y$).

 Модель Гильберта-Эллиота получается при тех же предположениях относительно канала, но без разделения на "хорошее" \; и "плохое"\; состояния.

 Модель  Фричмана-Свободы также является частным случаем рассматриваемой модели и может быть получена, если положить:

 1) число состояний равным $N$;

 2) матрицу переходных вероятностей имеющей вид
  $$A=
         \left(\begin{array}{ccccc}
           A_{11} & 0 & \ldots & 0 & A_{1N} \\
           0 & A_{22} & \ldots & 0 & A_{2N} \\
           \vdots & \vdots & \ddots & \vdots & \vdots \\
           0 & 0 & \ldots & A_{N-1,N-1} & A_{N-1,N}\\
           A_{N,1} & A_{N,2} & \ldots & A_{N,N-1}& A_{N,N}
        \end{array}\right);$$

  3) мощность выходного алфавита равной 2 (т. е. алфавит наблюдаемых символов --- поле $\mathbb{F}_2$);

  4) матрицу вероятностей появления наблюдаемых символов равной
      $$B=
        \left(\begin{array}{cccc}
           1 & 0 \\
           1 & 0  \\
           \vdots & \vdots \\
           1-\varepsilon & \varepsilon
        \end{array}\right).$$


